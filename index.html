<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="author" content="Conway">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/cmd.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js">
</script>
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#7000ff">
<meta name="msapplication-TileColor" content="#00aba9">
<meta name="theme-color" content="#ffffff">
<title>Conway's markdown (CMD)</title>
</head>
<body onload="let elements = document.getElementsByClassName(&quot;js-maths&quot;);
for (let i = 0; i &lt; elements.length; i++) {
  let element = elements[i]
  katex.render(
    element.textContent,
    element,
    {displayMode: element.tagName == &quot;DIV&quot;}
  );
}">
<h1>Conway's markdown (CMD)</h1>
<div class="page-properties">
First created: 2020-04-05<br>
Last modified: 2020-04-13
</div>
<ul>
<li>This page's source CMD: <a href="https://github.com/conway-markdown/conway-markdown.github.io/blob/master/index.cmd" title="GitHub: index.cmd"><code>index.cmd</code></a>
</li>
<li>This page's output HTML: <a href="https://github.com/conway-markdown/conway-markdown.github.io/blob/master/index.html" title="GitHub: index.html"><code>index.html</code></a>
</li>
<li>GitHub repositories:
<a href="https://github.com/conway-markdown/conway-markdown/" title="GitHub: Conway's markdown"><code>conway-markdown</code></a>,
<a href="https://github.com/conway-markdown/conway-markdown.github.io/" title="GitHub: Documentation for Conway's markdown (GitHub pages)"><code>conway-markdown.github.io</code></a>
</li>
</ul>
<p>
Conway's fence-style markdown,
implemented in Python using regex replacements.
</p>
<p>
Conway's markdown (CMD) is the result of someone joking that
"the filenames would look like Windows executables from the 90s".
Inspired by the backticks of John Gruber's <a href="https://daringfireball.net/projects/markdown/" title="Daring Fireball: Markdown">markdown</a>,
Conway's markdown uses fence-style constructs
where an <span class="repeatable-delimiter">arbitrarily repeatable delimiter symbol</span>
is used to wrap shorter runs of that symbol.
</p>
<h2 id="usage"><a class="self-link" href="#usage"></a>Usage</h2>
<p>
Convert a CMD file to HTML, outputting to <code>cmd_name.html</code>:
</p>
<pre><code>$ python cmd.py [cmd_name[.[cmd]]]
</code></pre>
<p>
Omit <code>[cmd_name[.[cmd]]]</code> to convert all CMD files
in the current directory (at all levels),
except those listed in <code>.cmdignore</code>.
</p>
<h2 id="syntax"><a class="self-link" href="#syntax"></a>Syntax</h2>
<p>
Since CMD-to-HTML conversion is merely a bunch of regex replacements
with some dictionaries for temporary storage of strings,
the syntax for earlier replacements will have higher precedence
than that for later replacements.
The syntax of CMD, in the order of processing, is thus:
</p>
<h3 id="cmd-literals"><a class="self-link" href="#cmd-literals"></a>CMD literals</h3>
<pre class="cmd syntax"><code>(<span class="repeatable-delimiter">!</span> <span class="mandatory-argument">{content}</span> <span class="repeatable-delimiter">!</span>)</code></pre>
<p>
Produces <code><span class="mandatory-argument">{content}</span></code> literally,
with HTML syntax-character escaping and de-indentation.
Whitespace around <code><span class="mandatory-argument">{content}</span></code> is stripped.
For <code><span class="mandatory-argument">{content}</span></code> containing one or more consecutive exclamation marks
followed by a closing round bracket,
use a greater number of <span class="repeatable-delimiter">exclamation marks</span> in the delimiters.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>Escaping: (! &amp; &lt; &gt; !).
Whitespace stripping: {(!      yes      !)}.
Enough exclamation marks: (!!! (!! (! never !) !!) !!!).
</code></pre>
</li>
<li>HTML
<pre class="html"><code>Escaping: &amp;amp; &amp;lt; &amp;gt;.
Whitespace stripping: {yes}.
Enough exclamation marks: (!! (! never !) !!).
</code></pre>
</li>
<li>Rendered
<p>
Escaping: &amp; &lt; &gt;.
Whitespace stripping: {yes}.
Enough exclamation marks: (!! (! never !) !!).
</p>
</li>
</ul>
<p>
CMD literals are very powerful.
For example, <code>id</code> and <code>class</code> in CMD block syntax
are specified in the form <code><span class="optional-argument">[id]</span>[<span class="optional-argument">[class]</span>]</code>.
Now, if for whatever reason you want an <code>id</code>
with square brackets, e.g.&nbsp;<code>[dumb-id]</code>,
then wrapping it inside a CMD literal will prevent it
from being interpreted as the class <code>dumb-id</code>:
</p>
<ul>
<li>CMD
<pre class="cmd"><code>``[dumb-id]
  Whoops!
``
``(! [dumb-id] !)
  That's better.
``
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;pre class="dumb-id"&gt;&lt;code&gt;Whoops!
&lt;/code&gt;&lt;/pre&gt;
&lt;pre id="[dumb-id]"&gt;&lt;code&gt;That's better.
&lt;/code&gt;&lt;/pre&gt;
</code></pre>
</li>
</ul>
<h3 id="display-code"><a class="self-link" href="#display-code"></a>Display code</h3>
<pre class="cmd syntax"><code><span class="repeatable-delimiter">``</span><span class="optional-argument">[id]</span>[<span class="optional-argument">[class]</span>]↵ <span class="mandatory-argument">{content}</span> <span class="repeatable-delimiter">``</span></code></pre>
<p>
The delimiting backticks must be
the first non-whitespace characters on their lines.
If <code><span class="optional-argument">[class]</span></code> is empty, the square brackets surrounding it may be omitted.
</p>
<p>
Produces the display code
<code>&lt;pre id="<span class="optional-argument">[id]</span>" class="<span class="optional-argument">[class]</span>"&gt;&lt;code&gt;<span class="mandatory-argument">{content}</span>&lt;/code&gt;&lt;/pre&gt;</code>,
with HTML syntax-character escaping
and de-indentation for <code><span class="mandatory-argument">{content}</span></code>.
For <code><span class="mandatory-argument">{content}</span></code> containing two or more consecutive backticks,
use a greater number of <span class="repeatable-delimiter">backticks</span> in the delimiters.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>``id-0[class-1 class-2]
    Escaping: &amp; &lt; &gt;.
    Note that CMD literals have higher precedence,
    since they are processed first: (!! (! literally !) !!).
        Uniform
        de-indentation:
        yes.
``
````
  ``
  Use more backticks as required.
  If [id] and [class] are omitted,
  no corresponding attributes are generated.
  ``
````
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;pre id="id-0" class="class-1 class-2"&gt;&lt;code&gt;Escaping: &amp;amp; &amp;lt; &amp;gt;.
Note that CMD literals have higher precedence,
since they are processed first: (! literally !).
    Uniform
    de-indentation:
    yes.
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;``
Use more backticks as required.
If [id] and [class] are omitted,
no corresponding attributes are generated.
``
&lt;/code&gt;&lt;/pre&gt;
</code></pre>
</li>
<li>Rendered
<pre id="id-0" class="class-1 class-2"><code>Escaping: &amp; &lt; &gt;.
Note that CMD literals have higher precedence,
since they are processed first: (! literally !).
    Uniform
    de-indentation:
    yes.
</code></pre>
<pre><code>``
Use more backticks as required.
If [id] and [class] are omitted,
no corresponding attributes are generated.
``
</code></pre>
</li>
</ul>
<h3 id="inline-code"><a class="self-link" href="#inline-code"></a>Inline code</h3>
<pre class="cmd syntax"><code><span class="repeatable-delimiter">`</span> <span class="mandatory-argument">{content}</span> <span class="repeatable-delimiter">`</span></code></pre>
<p>
Produces the inline code
<code>&lt;code&gt;<span class="mandatory-argument">{content}</span>&lt;/code&gt;</code>,
with HTML syntax-character escaping
and de-indentation for <code><span class="mandatory-argument">{content}</span></code>.
Whitespace around <code><span class="mandatory-argument">{content}</span></code> is stripped.
For <code><span class="mandatory-argument">{content}</span></code> containing one or more consecutive backticks
which are not protected by <a href="#cmd-literals">CMD literals</a>,
use a greater number of <span class="repeatable-delimiter">backticks</span> in the delimiters.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>`` The escaped form of &amp; is &amp;amp;. Here is a tilde: `. ``
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;code&gt;The escaped form of &amp;amp; is &amp;amp;amp;. Here is a tilde: `.&lt;/code&gt;
</code></pre>
</li>
<li>Rendered
<p>
<code>The escaped form of &amp; is &amp;amp;. Here is a tilde: `.</code>
</p>
</li>
</ul>
<h3 id="comments"><a class="self-link" href="#comments"></a>Comments</h3>
<pre class="cmd syntax"><code>&lt;!-- <span class="mandatory-argument">{comment}</span> --&gt;</code></pre>
<p>
Removed, along with any preceding horizontal whitespace.
Although comments are weaker than literals and code
they may still be used to remove them.
For instance <code>(! A &lt;!-- B --&gt; !)</code> becomes <code>A &lt;!-- B --&gt;</code>,
whereas <code>&lt;!-- A (! B !) --&gt;</code> is removed entirely.
In this sense they are stronger than literals and code.
</p>
<h3 id="display-maths"><a class="self-link" href="#display-maths"></a>Display maths</h3>
<pre class="cmd syntax"><code><span class="repeatable-delimiter">$$</span><span class="optional-argument">[id]</span>[<span class="optional-argument">[class]</span>]↵ <span class="mandatory-argument">{content}</span> <span class="repeatable-delimiter">$$</span></code></pre>
<p>
The delimiting dollar signs must be
the first non-whitespace characters on their lines.
If <code><span class="optional-argument">[class]</span></code> is empty, the square brackets surrounding it may be omitted.
</p>
<p>
Produces
<code>&lt;div id="<span class="optional-argument">[id]</span>" class="js-maths <span class="optional-argument">[class]</span>"&gt;<span class="mandatory-argument">{content}</span>&lt;/div&gt;</code>,
with HTML syntax-character escaping
and de-indentation for <code><span class="mandatory-argument">{content}</span></code>.
For <code><span class="mandatory-argument">{content}</span></code> containing two or more consecutive dollar signs
which are not protected by <a href="#cmd-literals">CMD literals</a>,
use a greater number of <span class="repeatable-delimiter">dollar signs</span> in the delimiters.
</p>
<p>
This is to be used with some sort of JavaScript code
which renders equations based on the class <code>js-maths</code>.
Here I am using <a href="https://katex.org/" title="KaTeX — The fastest math typesetting library for the web">KaTeX</a>.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>$$
  1 + \frac{1}{2^2} + \frac{1}{3^2} + \dots
  = \frac{\pi^2}{6}
  &lt; 2
$$
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;div class="js-maths"&gt;1 + \frac{1}{2^2} + \frac{1}{3^2} + \dots
= \frac{\pi^2}{6}
&amp;lt; 2
&lt;/div&gt;
</code></pre>
</li>
<li>Rendered
<div class="js-maths">1 + \frac{1}{2^2} + \frac{1}{3^2} + \dots
= \frac{\pi^2}{6}
&lt; 2
</div>
</li>
</ul>
<h3 id="inline-maths"><a class="self-link" href="#inline-maths"></a>Inline maths</h3>
<pre class="cmd syntax"><code><span class="repeatable-delimiter">$</span> <span class="mandatory-argument">{content}</span> <span class="repeatable-delimiter">$</span></code></pre>
<p>
Produces
<code>&lt;span class="js-maths"&gt;<span class="mandatory-argument">{content}</span>&lt;/span&gt;</code>,
with HTML syntax-character escaping for <code><span class="mandatory-argument">{content}</span></code>.
Whitespace around <code><span class="mandatory-argument">{content}</span></code> is stripped.
For <code><span class="mandatory-argument">{content}</span></code> containing one or more consecutive dollar signs
which are not protected by <a href="#cmd-literals">CMD literals</a>,
use a greater number of <span class="repeatable-delimiter">dollar signs</span> in the delimiters.
</p>
<p>
This is to be used with some sort of JavaScript code
which renders equations based on the class <code>js-maths</code>.
Here I am using <a href="https://katex.org/" title="KaTeX — The fastest math typesetting library for the web">KaTeX</a>.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>A contrived instance of multiple dollar signs in inline maths:
$$$ \text{Yea, \$$d$ means $d$~dollars.} $$$
</code></pre>
</li>
<li>HTML
<pre class="html"><code>A contrived instance of multiple dollar signs in inline maths:
&lt;span class="js-maths"&gt;\text{Yea, \$$d$ means $d$~dollars.}&lt;/span&gt;
</code></pre>
</li>
<li>Rendered
<p>
A contrived instance of multiple dollar signs in inline maths:
<span class="js-maths">\text{Yea, \$$d$ means $d$~dollars.}</span>
</p>
</li>
</ul>
<h3 id="inclusions"><a class="self-link" href="#inclusions"></a>Inclusions</h3>
<pre class="cmd syntax"><code>(<span class="repeatable-delimiter">+</span> <span class="mandatory-argument">{file name}</span> <span class="repeatable-delimiter">+</span>)</code></pre>
<p>
Includes the content of the file <code><span class="mandatory-argument">{file name}</span></code>.
For <code><span class="mandatory-argument">{file name}</span></code> containing one or more consecutive plus signs
followed by a closing round bracket,
use a greater number of <span class="repeatable-delimiter">plus signs</span> in the delimiters.
</p>
<p>
All of the syntax above (CMD literals through to inline maths) is processed.
Unlike nested <code>\input</code> in LaTeX, nested inclusions are not processed.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>(+ inclusion.txt +)
</code></pre>
</li>
<li>HTML
<pre class="html"><code>This is content from &lt;a href="/inclusion.txt"&gt;&lt;code&gt;inclusion.txt&lt;/code&gt;&lt;/a&gt;.
Nested inclusions are not processed,
so there is no need to worry about recursion errors: (+ inclusion.txt +)
</code></pre>
</li>
<li>Rendered
<p>
This is content from <a href="/inclusion.txt"><code>inclusion.txt</code></a>.
Nested inclusions are not processed,
so there is no need to worry about recursion errors: (+ inclusion.txt +)
</p>
</li>
</ul>
<h3 id="regex-replacements"><a class="self-link" href="#regex-replacements"></a>Regex replacements</h3>
<pre class="cmd syntax"><code>{<span class="repeatable-delimiter">%</span> <span class="mandatory-argument">{pattern}</span> <span class="repeatable-delimiter">%</span> <span class="mandatory-argument">{replacement}</span> <span class="repeatable-delimiter">%</span>}</code></pre>
<p>
Processes regex replacements of <code><span class="mandatory-argument">{pattern}</span></code> by <code><span class="mandatory-argument">{replacement}</span></code>
in Python syntax with the flags <code>re.MULTILINE</code> and <code>re.VERBOSE</code> enabled.
Whitespace around <code><span class="mandatory-argument">{pattern}</span></code> and <code><span class="mandatory-argument">{replacement}</span></code> is stripped.
For <code><span class="mandatory-argument">{pattern}</span></code> or <code><span class="mandatory-argument">{replacement}</span></code> containing
one or more consecutive percent signs,
use a greater number of <span class="repeatable-delimiter">percent signs</span> in the delimiters.
For <code><span class="mandatory-argument">{pattern}</span></code> matching any of the syntax above,
which should not be processed using that syntax, use CMD literals.
</p>
<p>
All regex replacement specifications are read and stored
before being applied in order.
If the same pattern is specified more than once,
the latest specification shall prevail.
</p>
<p>
As an example, the following regex replacement is used
to automatically insert the self-link anchors
before the section headings (<code>&lt;h2&gt;</code> to <code>&lt;h6&gt;</code>) in this page:
</p>
<pre class="cmd"><code>{%
  ^ [^\S\n]*
  (?P&lt;hashes&gt; [#]{2,6} (?![#]) )
    (?P&lt;id_&gt; [\S]*? )
  [\s]+
    (?P&lt;content&gt; [\s\S]*? )
  (?P=hashes)
%
  \g&lt;hashes&gt;\g&lt;id_&gt;
    [][self-link:\g&lt;id_&gt;]\\
    \g&lt;content&gt;
  \g&lt;hashes&gt;
  @@[self-link:\g&lt;id_&gt;][self-link]
    \\#\g&lt;id_&gt;
  @@
%}
</code></pre>
<p>
<strong>Warning:</strong> malicious or careless user-defined regex replacements
will break the normal CMD syntax.
To avoid breaking placeholder storage
(used to protect portions of the markup from further processing),
do not use replacements to alter placeholder strings,
which are of the form <code><span class="mandatory-argument">{n}</span></code>,
where <code></code> is the placeholder marker <code>U+E000</code> (Private Use Area)
and <code><span class="mandatory-argument">{n}</span></code> is an integer.
To avoid breaking properties,
do not use replacements to alter property strings,
which are of the form <code>%<span class="mandatory-argument">{property name}</span></code>.
</p>
<h3 id="ordinary-replacements"><a class="self-link" href="#ordinary-replacements"></a>Ordinary replacements</h3>
<pre class="cmd syntax"><code>{<span class="repeatable-delimiter">:</span> <span class="mandatory-argument">{pattern}</span> <span class="repeatable-delimiter">:</span> <span class="mandatory-argument">{replacement}</span> <span class="repeatable-delimiter">:</span>}</code></pre>
<p>
Processes ordinary replacements of <code><span class="mandatory-argument">{pattern}</span></code> by <code><span class="mandatory-argument">{replacement}</span></code>.
Whitespace around <code><span class="mandatory-argument">{pattern}</span></code> and <code><span class="mandatory-argument">{replacement}</span></code> is stripped.
For <code><span class="mandatory-argument">{pattern}</span></code> or <code><span class="mandatory-argument">{replacement}</span></code> containing
one or more consecutive colons,
use a greater number of <span class="repeatable-delimiter">colons</span> in the delimiters.
</p>
<p>
All ordinary replacement specifications are read and stored
before being applied in order.
If the same pattern is specified more than once,
the latest specification shall prevail.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>{: |hup-hup| : Huzzah! :}
|hup-hup| \\

{: \def1 : Earlier specifications lose. :}
{: \def1 : Later specifications win. :}
\def1 \\

\def2 \\
{: \def2 : Specifications can be given anywhere. :}

{: &lt;out&gt; : Nesting will work provided the &lt;in&gt; is given later. :}
{: &lt;in&gt; : inner specification :}
&lt;out&gt;
</code></pre>
</li>
<li>Rendered
<p>
Huzzah!<br>
Later specifications win.<br>
Specifications can be given anywhere.<br>
Nesting will work provided the inner specification is given later.
</p>
</li>
</ul>
<p>
<strong>Warning:</strong> malicious or careless user-defined ordinary replacements
will break the normal CMD syntax.
To avoid breaking placeholder storage
(used to protect portions of the markup from further processing),
do not use replacements to alter placeholder strings,
which are of the form <code><span class="mandatory-argument">{n}</span></code>,
where <code></code> is the placeholder marker <code>U+E000</code> (Private Use Area)
and <code><span class="mandatory-argument">{n}</span></code> is an integer.
To avoid breaking properties,
do not use replacements to alter property strings,
which are of the form <code>%<span class="mandatory-argument">{property name}</span></code>.
</p>
<h3 id="preamble"><a class="self-link" href="#preamble"></a>Preamble</h3>
<pre class="cmd syntax"><code><span class="repeatable-delimiter">%%</span>↵ <span class="mandatory-argument">{content}</span> <span class="repeatable-delimiter">%%</span></code></pre>
<p>
The delimiting percent signs must be
the first non-whitespace characters on their lines.
</p>
<p>
Processes the preamble, whose <code><span class="mandatory-argument">{content}</span></code> is to consist of
property specifications of the form
<code>%<span class="mandatory-argument">{property name}</span> <span class="mandatory-argument">{property markup}</span></code>,
which are stored and may be referenced by writing <code>%<span class="mandatory-argument">{property name}</span></code>,
called a property string, anywhere else in the document.
<code><span class="mandatory-argument">{property name}</span></code> may only contain letters, digits, and hyphens.
If the same property is specified more than once,
the latest specification shall prevail.
</p>
<p>
This produces the HTML preamble,
i.e.&nbsp;everything from <code>&lt;!DOCTYPE html&gt;</code> through to <code>&lt;body&gt;</code>.
</p>
<p>
For <code><span class="mandatory-argument">{property markup}</span></code> matching a <code><span class="mandatory-argument">{property name}</span></code> pattern,
use a CMD literal, e.g. <code>(! a literal %propety-name !)</code>.
For <code><span class="mandatory-argument">{content}</span></code> containing two or more consecutive percent signs
which are not protected by CMD literals,
use a greater number of <span class="repeatable-delimiter">percent signs</span> in the delimiters.
</p>
<p>
Only the first occurrence of a preamble in the markup is processed.
</p>
<p>
The following properties, called original properties,
are accorded special treatment.
If omitted from a preamble,
they take the default values shown beside them:
</p>
<pre class="cmd"><code>%lang en
%title Title
%title-suffix
%author
%date-created yyyy-mm-dd
%date-modified yyyy-mm-dd
%resources
%description
%css
%onload-js
%footer-copyright-remark
%footer-remark
</code></pre>
<p>
The following properties, called derived properties,
are computed based on the supplied original properties:
</p>
<pre class="cmd"><code>%html-lang-attribute
%meta-element-author
%meta-element-description
%title-element
%style-element
%body-onload-attribute
%year-created
%year-modified
%year-modified-next
%footer-element
%url
</code></pre>
<h4 id="preamble-minimal"><a class="self-link" href="#preamble-minimal"></a>Example 1: a minimal HTML file</h4>
<ul>
<li>CMD
<pre class="cmd"><code>%%
%%
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="utf-8"&gt;
&lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</li>
</ul>
<h4 id="preamble-not-minimal"><a class="self-link" href="#preamble-not-minimal"></a>Example 2: a not-so-minimal HTML file</h4>
<ul>
<li>CMD
<pre class="cmd"><code>%%
  %lang en-AU
  %title My title
  %title-suffix \ | My site
  %author Me
  %date-created 2020-04-11
  %date-modified 2020-04-11
  %description
    This is the description. Hooray for automatic escaping (&amp;, &lt;, &gt;, ")!
  %css
    #special {
      color: purple;
    }
  %onload-js
    special.textContent += ' This is a special paragraph!'
%%

# %title #

----special
  The title of this page is "%title", and the author is %author.
  At the time of writing, next year will be %year-modified-next.
----

%footer-element
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en-AU"&gt;
&lt;head&gt;
&lt;meta charset="utf-8"&gt;
&lt;meta name="author" content="Me"&gt;
&lt;meta name="description" content="This is the description. Hooray for automatic escaping (&amp;amp;, &amp;lt;, &amp;gt;, &amp;quot;)!"&gt;
&lt;title&gt;My title | My site&lt;/title&gt;
&lt;style&gt;#special {
  color: purple;
}&lt;/style&gt;
&lt;/head&gt;
&lt;body onload="special.textContent += ' This is a special paragraph!'"&gt;
&lt;h1&gt;My title&lt;/h1&gt;
&lt;p id="special"&gt;
The title of this page is "My title", and the author is Me.
At the time of writing, next year will be 2021.
&lt;/p&gt;
&lt;footer&gt;
&lt;hr&gt;
©&amp;nbsp;2020&amp;nbsp;Me.
&lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</li>
</ul>
<h3 id="headings"><a class="self-link" href="#headings"></a>Headings</h3>
<pre class="cmd syntax"><code>#<span class="optional-argument">[id]</span> <span class="mandatory-argument">{content}</span> #</code></pre>
<p>
Produces the heading
<code>&lt;h1 id="<span class="optional-argument">[id]</span>"&gt;<span class="mandatory-argument">{content}</span>&lt;/h1&gt;</code>.
Whitespace around <code><span class="mandatory-argument">{content}</span></code> is stripped.
For <code>&lt;h2&gt;</code> to <code>&lt;h6&gt;</code>, use 2 to 6 delimiting hashes respectively.
For <code><span class="mandatory-argument">{content}</span></code> containing the delimiting number of
or more consecutive hashes, use <a href="#cmd-literals">CMD literals</a>.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>###some-id Heading with id ###
#### Heading without id ####
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;h3 id="some-id"&gt;Heading with id&lt;/h3&gt;
&lt;h4&gt;Heading without id&lt;/h4&gt;
</code></pre>
</li>
</ul>
<h3 id="blocks"><a class="self-link" href="#blocks"></a>Blocks</h3>
<pre class="cmd syntax"><code><span class="repeatable-delimiter">cccc</span><span class="optional-argument">[id]</span>[<span class="optional-argument">[class]</span>]↵ <span class="mandatory-argument">{content}</span> <span class="repeatable-delimiter">cccc</span></code></pre>
<p>
The delimiting characters (<code>c</code>) must be
the first non-whitespace characters on their lines.
If <code><span class="optional-argument">[class]</span></code> is empty, the square brackets surrounding it may be omitted.
</p>
<p>
Produces the block
<code>&lt;<span class="mandatory-argument">{tag name}</span> id="<span class="optional-argument">[id]</span>" class="<span class="optional-argument">[class]</span>"&gt;↵<span class="mandatory-argument">{content}</span>&lt;/<span class="mandatory-argument">{tag name}</span>&gt;</code>.
For <code><span class="mandatory-argument">{content}</span></code> containing four or more
consecutive delimiting characters
which are not protected by <a href="#cmd-literals">CMD literals</a>,
use a greater number of <span class="repeatable-delimiter">delimiting characters</span> in the delimiters.
</p>
<p>
The following delimiting characters (<code>c</code>) are used:
</p>
<ul>
<li>Non-lists:
<ul>
<li><code>-</code> for <code>&lt;p&gt;</code>
</li>
<li><code>|</code> for <code>&lt;div&gt;</code>
</li>
<li><code>"</code> for <code>&lt;blockquote&gt;</code>
</li>
</ul>
</li>
<li>Lists:
<ul>
<li><code>=</code> for <code>&lt;ul&gt;</code>
</li>
<li><code>+</code> for <code>&lt;ol&gt;</code>
</li>
</ul>
</li>
</ul>
<p>
In the implementation, a recursive call is used to process nested blocks.
</p>
<h4 id="list-items"><a class="self-link" href="#list-items"></a>List items</h4>
<p>
For list blocks, <code><span class="mandatory-argument">{content}</span></code> is split into list items <code>&lt;li&gt;</code>
according to leading occurrences
(i.e. occurrences preceded only by whitespace on their lines)
of the following:
</p>
<pre class="cmd syntax"><code>Y<span class="optional-argument">[id]</span>[<span class="optional-argument">[class]</span>]</code></pre>
<p>
The following delimiters (<code>Y</code>) for list items are used:
</p>
<ul>
<li><code>*</code> (or any run of asterisks)
</li>
<li><code>1.</code> (or any run of digits followed by a full stop)
</li>
</ul>
<p>
If <code><span class="optional-argument">[class]</span></code> is empty,
the square brackets surrounding it may be omitted.
</p>
<h4 id="blocks-nesting"><a class="self-link" href="#blocks-nesting"></a>Example 1: nesting</h4>
<ul>
<li>CMD
<pre class="cmd"><code>----
A paragraph.
----
======
* A nested unordered list:
  ====
  1. Unlike John Gruber's markdown, indentation doesn't matter.
      * This is on the same level as the item above.
  ====
* A nested ordered list:
  ++++
  * Asterisk `&lt;li&gt;` markers can be used for `&lt;ol&gt;`.
  **** An arbitrarily long run of asterisks can be used.
  2.  An easy way to remember the list delimiters is that
      unordered list items stay constant (`=`) while
      ordered list items increment (`+`).
  ++++
0. Numbered `&lt;li&gt;` markers can be used for `&lt;ul&gt;`
99999999. Any non-negative integer will do.
  """"""
  Someone might quote this later. 
  ====
  * Yes, I know.
  ====
  """"""
1. They all get turned into `&lt;li&gt;` tags regardless.
======
</code></pre>
</li>
<li>Rendered
<p>
A paragraph.
</p>
<ul>
<li>A nested unordered list:
<ul>
<li>Unlike John Gruber's markdown, indentation doesn't matter.
</li>
<li>This is on the same level as the item above.
</li>
</ul>
</li>
<li>A nested ordered list:
<ol>
<li>Asterisk <code>&lt;li&gt;</code> markers can be used for <code>&lt;ol&gt;</code>.
</li>
<li>An arbitrarily long run of asterisks can be used.
</li>
<li>An easy way to remember the list delimiters is that
unordered list items stay constant (<code>=</code>) while
ordered list items increment (<code>+</code>).
</li>
</ol>
</li>
<li>Numbered <code>&lt;li&gt;</code> markers can be used for <code>&lt;ul&gt;</code>
</li>
<li>Any non-negative integer will do.
<blockquote>
Someone might quote this later.
<ul>
<li>Yes, I know.
</li>
</ul>
</blockquote>
</li>
<li>They all get turned into <code>&lt;li&gt;</code> tags regardless.
</li>
</ul>
</li>
</ul>
<h4 id="blocks-id-class"><a class="self-link" href="#blocks-id-class"></a>Example 2: <code>id</code> and <code>class</code></h4>
<ul>
<li>CMD
<pre class="cmd"><code>----p-id[p-class]
Paragraph with `id` and `class`.
----
======
*li-id List item with `id` and no `class`.
0.[li-class] List item with `class` and no `id`.
1.[li-class]
  Put arbitrary whitespace after the class for more clarity.
======
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;p id="p-id" class="p-class"&gt;
Paragraph with &lt;code&gt;id&lt;/code&gt; and &lt;code&gt;class&lt;/code&gt;.
&lt;/p&gt;
&lt;ul&gt;
&lt;li id="li-id"&gt;List item with &lt;code&gt;id&lt;/code&gt; and no &lt;code&gt;class&lt;/code&gt;.
&lt;/li&gt;
&lt;li class="li-class"&gt;List item with &lt;code&gt;class&lt;/code&gt; and no &lt;code&gt;id&lt;/code&gt;.
&lt;/li&gt;
&lt;li class="li-class"&gt;Put arbitrary whitespace after the class for more clarity.
&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
</li>
</ul>
<h3 id="tables"><a class="self-link" href="#tables"></a>Tables</h3>
<pre class="cmd syntax"><code><span class="repeatable-delimiter">''''</span><span class="optional-argument">[id]</span>[<span class="optional-argument">[class]</span>]↵ <span class="mandatory-argument">{content}</span> <span class="repeatable-delimiter">''''</span></code></pre>
<p>
The delimiting apostrophes must be
the first non-whitespace characters on their lines.
If <code><span class="optional-argument">[class]</span></code> is empty, the square brackets surrounding it may be omitted.
</p>
<p>
Produces the block
<code>&lt;table id="<span class="optional-argument">[id]</span>" class="<span class="optional-argument">[class]</span>"&gt;↵<span class="mandatory-argument">{content}</span>&lt;/table&gt;</code>.
For <code><span class="mandatory-argument">{content}</span></code> containing four or more apostrophes
which are not protected by <a href="#cmd-literals">CMD literals</a>,
use a greater number of <span class="repeatable-delimiter">apostrophes</span> in the delimiters.
</p>
<p>
In the implementation, a recursive call is used to process nested tables.
</p>
<p>
<code><span class="mandatory-argument">{content}</span></code> is
</p>
<ol>
<li>split into table cells <code>&lt;th&gt;</code>, <code>&lt;td&gt;</code>
according to <a href="#table-cells">table cell processing</a>,
</li>
<li>split into table rows <code>&lt;tr&gt;</code>
according to <a href="#table-rows">table row processing</a>, and
</li>
<li>split into table parts <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, <code>&lt;tfoot&gt;</code>
according to <a href="#table-parts">table part processing</a>.
</li>
</ol>
<h4 id="table-cells"><a class="self-link" href="#table-cells"></a>Table cells</h4>
<p>
<code><span class="mandatory-argument">{content}</span></code> is split into table cells <code>&lt;th&gt;</code>, <code>&lt;td&gt;</code>
according to leading occurrences
(i.e. occurrences preceded only by whitespace on their lines)
of the following:
</p>
<pre class="cmd syntax"><code>Z<span class="optional-argument">[id]</span>[<span class="optional-argument">[class]</span>]{<span class="optional-argument">[rowspan]</span>,<span class="optional-argument">[colspan]</span>}</code></pre>
<p>
The following delimiters (<code>Z</code>) for table cells are used:
</p>
<ul>
<li><code>;</code> (or any run of semicolons) for <code>&lt;th&gt;</code>
</li>
<li><code>,</code> (or any run of commas) for <code>&lt;td&gt;</code>
</li>
</ul>
<p>
Table cells end at the next table cell, table row, or table part,
or at the end of the content being split.
Non-empty <code><span class="optional-argument">[rowspan]</span></code> and <code><span class="optional-argument">[colspan]</span></code> must consist of digits only.
If <code><span class="optional-argument">[class]</span></code> is empty,
the square brackets surrounding it may be omitted.
If <code><span class="optional-argument">[colspan]</span></code> is empty, the comma before it may be omitted.
If both <code><span class="optional-argument">[rowspan]</span></code> and <code><span class="optional-argument">[colspan]</span></code> are empty,
the comma between them and the curly brackets surrounding them may be omitted.
</p>
<h4 id="table-rows"><a class="self-link" href="#table-rows"></a>Table rows</h4>
<p>
<code><span class="mandatory-argument">{content}</span></code> is split into table rows <code>&lt;tr&gt;</code>
according to leading occurrences
(i.e. occurrences preceded only by whitespace on their lines)
of the following:
</p>
<pre class="cmd syntax"><code>/<span class="optional-argument">[id]</span>[<span class="optional-argument">[class]</span>]</code></pre>
<p>
The slash may instead be any run of slashes.
</p>
<p>
Table rows end at the next table row or table part,
or at the end of the content being split.
If <code><span class="optional-argument">[class]</span></code> is empty,
the square brackets surrounding it may be omitted.
</p>
<h4 id="table-parts"><a class="self-link" href="#table-parts"></a>Table parts</h4>
<p>
<code><span class="mandatory-argument">{content}</span></code> is split into table parts <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, <code>&lt;tfoot&gt;</code>
according to leading occurrences
(i.e. occurrences preceded only by whitespace on their lines)
of the following:
</p>
<pre class="cmd syntax"><code>Y<span class="optional-argument">[id]</span>[<span class="optional-argument">[class]</span>]</code></pre>
<p>
The following delimiters (<code>Y</code>) for table parts are used:
</p>
<ul>
<li><code>^</code> (or any run of carets) for <code>&lt;thead&gt;</code>
</li>
<li><code>~</code> (or any run of tildes) for <code>&lt;tbody&gt;</code>
</li>
<li><code>_</code> (or any run of underscores) for <code>&lt;tfoot&gt;</code>
</li>
</ul>
<p>
Table parts end at the next table part,
or at the end of the content being split.
If <code><span class="optional-argument">[class]</span></code> is empty,
the square brackets surrounding it may be omitted.
</p>
<h4 id="tables-without-parts"><a class="self-link" href="#tables-without-parts"></a>Example 1: table <em>without</em> <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, <code>&lt;tfoot&gt;</code> parts</h4>
<ul>
<li>CMD
<pre class="cmd"><code>''''
  //
    ; A
    ; B
    ; C
    ; D
  //
    , 1
    ,{2} 2
    , 3
    , 4
  //
    , 5
    ,{3,2} 6
  //
    ,{,2} 7
  //
    , 8
    ; ?
''''
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;table&gt;
&lt;tr&gt;
&lt;th&gt;A&lt;/th&gt;
&lt;th&gt;B&lt;/th&gt;
&lt;th&gt;C&lt;/th&gt;
&lt;th&gt;D&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td rowspan="2"&gt;2&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td rowspan="3" colspan="2"&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td colspan="2"&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;th&gt;?&lt;/th&gt;
&lt;/tr&gt;
&lt;/table&gt;
</code></pre>
</li>
<li>Rendered
<table>
<tr>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
<tr>
<td>1</td>
<td rowspan="2">2</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>5</td>
<td rowspan="3" colspan="2">6</td>
</tr>
<tr>
<td colspan="2">7</td>
</tr>
<tr>
<td>8</td>
<th>?</th>
</tr>
</table>
</li>
</ul>
<h4 id="tables-with-parts"><a class="self-link" href="#tables-with-parts"></a>Example 2: table <em>with</em> <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, <code>&lt;tfoot&gt;</code> parts</h4>
<ul>
<li>CMD
<pre class="cmd"><code>''''
^^^
  //
    ; Meals
    ; Cost / (! $ !)
~~~
  //
    ; Lunch
    , 7
  //
    ; Dinner
    , 10
___
  //
    ; Total
    ,total-cost[some-class]
      17
''''
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Meals&lt;/th&gt;
&lt;th&gt;Cost / $&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;th&gt;Lunch&lt;/th&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;Dinner&lt;/th&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;
&lt;tr&gt;
&lt;th&gt;Total&lt;/th&gt;
&lt;td id="total-cost" class="some-class"&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;/tfoot&gt;
&lt;/table&gt;
</code></pre>
</li>
<li>Rendered
<table>
<thead>
<tr>
<th>Meals</th>
<th>Cost / $</th>
</tr>
</thead>
<tbody>
<tr>
<th>Lunch</th>
<td>7</td>
</tr>
<tr>
<th>Dinner</th>
<td>10</td>
</tr>
</tbody>
<tfoot>
<tr>
<th>Total</th>
<td id="total-cost" class="some-class">17</td>
</tr>
</tfoot>
</table>
</li>
</ul>
<h3 id="punctuation"><a class="self-link" href="#punctuation"></a>Punctuation (or, escapes)</h3>
<div class="centred-flex">
<table>
<tr>
<th>CCH</th>
<th>HTML</th>
<th>Rendered</th>
<th>Description</th>
</tr>
<tr>
<td><code>\\</code></td>
<td><code>&lt;br&gt;</code></td>
<td><br></td>
<td>Line break</td>
</tr>
<tr>
<td><code>\/</code></td>
<td></td>
<td></td>
<td>Empty string</td>
</tr>
<tr>
<td><code>\ /</code></td>
<td><code> </code></td>
<td> </td>
<td>Space</td>
</tr>
<tr>
<td><code>\ </code></td>
<td><code> </code></td>
<td> </td>
<td>Space</td>
</tr>
<tr>
<td><code>\~</code></td>
<td><code>~</code></td>
<td>~</td>
<td>Tilde</td>
</tr>
<tr>
<td><code>~</code></td>
<td><code>&amp;nbsp;</code></td>
<td>&nbsp;</td>
<td>Non-breaking space</td>
</tr>
<tr>
<td><code>\0</code></td>
<td><code>&amp;numsp;</code></td>
<td>&numsp;</td>
<td>Figure space</td>
</tr>
<tr>
<td><code>\,</code></td>
<td><code>&amp;thinsp;</code></td>
<td>&thinsp;</td>
<td>Thin space</td>
</tr>
<tr>
<td><code>\&amp;</code></td>
<td><code>&amp;amp;</code></td>
<td>&amp;</td>
<td>Ampersand</td>
</tr>
<tr>
<td><code>\&lt;</code></td>
<td><code>&amp;lt;</code></td>
<td>&lt;</td>
<td>Less than</td>
</tr>
<tr>
<td><code>\&gt;</code></td>
<td><code>&amp;gt;</code></td>
<td>&gt;</td>
<td>Greater than</td>
</tr>
<tr>
<td><code>---</code></td>
<td><code>—</code></td>
<td>—</td>
<td><code>U+2014 EM DASH</code></td>
</tr>
<tr>
<td><code>--</code></td>
<td><code>–</code></td>
<td>–</td>
<td><code>U+2013 EN DASH</code></td>
</tr>
<tr>
<td><code>\P</code></td>
<td><code>¶</code></td>
<td>¶</td>
<td><code>U+00B6 PILCROW SIGN</code></td>
</tr>
<tr>
<td><code>\#</code></td>
<td><code>#</code></td>
<td>#</td>
<td>Hash</td>
</tr>
<tr>
<td><code>\*</code></td>
<td><code>*</code></td>
<td>*</td>
<td>Asterisk</td>
</tr>
<tr>
<td><code>\_</code></td>
<td><code>_</code></td>
<td>_</td>
<td>Underscore</td>
</tr>
</table>
</div>
<h3 id="line-continuations"><a class="self-link" href="#line-continuations"></a>Line continuations</h3>
<p>
Use backslashes for line continuation.
All leading whitespace on the next line is stripped.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>(Line 1)\
  (Line 2)
(Line 3) \
       (Line 4)
</code></pre>
</li>
<li>HTML
<pre class="html"><code>(Line 1)(Line 2)
(Line 3) (Line 4)
</code></pre>
</li>
</ul>
<footer>
<hr>
©&nbsp;2020&nbsp;Conway.
</footer>
</body>
</html>
