<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="author" content="Conway">
<meta name="description" content="Documentation for Conway-Markdown (CMD).">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/cmd.css">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#7000ff">
<meta name="msapplication-TileColor" content="#00aba9">
<meta name="theme-color" content="#ffffff">
<title>Conway-Markdown (CMD) v3.999...</title>
</head>
<body>
<h1>Conway-Markdown (CMD) v3.999...</h1>
<p>
Conway-Markdown (CMD) is:
</p>
<ul>
<li>
A replacement-driven markup language inspired by Markdown.
</li>
<li>
A demonstration of the folly of throwing regex at a parsing problem.
</li>
<li>
The result of someone joking that
<q>the filenames would look like Windows executables from the 90s</q>.
</li>
<li>
Implemented in <a href="https://packages.debian.org/stable/python3">Python 3.{whatever Debian stable is at}</a>.
</li>
<li>
Licensed under "MIT No Attribution" (MIT-0).
</li>
</ul>
<h2 id="installation-and-usage"><a href="#installation-and-usage" class="permalink" aria-label="Permalink"></a>Installation and usage</h2>
<ol start="0">
<li>
Clone the <a href="https://github.com/conway-markdown/conway-markdown">repository of the Python implementation</a>:
<pre><code>$ git clone https://github.com/conway-markdown/conway-markdown
</code></pre>
<p>
Since <code>cmd.py</code> is <a href="https://github.com/conway-markdown/conway-markdown/blob/master/cmd.py">a shitty single-file script</a>,
it will not be turned into a proper Python package.
</p>
</li>
</ol>
<h3 id="linux-terminals"><a href="#linux-terminals" class="permalink" aria-label="Permalink"></a>Linux terminals, macOS Terminal, Git BASH for Windows</h3>
<ol>
<li>
Make an alias for <code>cmd.py</code> in whatever dotfile
you configure your aliases in:
<pre><code>alias cmd='path/to/cmd.py'
</code></pre>
</li>
<li>
Invoke the alias to convert a CMD file to HTML:
<pre><code>$ cmd [-h] [-v] [-x] [file.cmd]

Convert Conway-Markdown (CMD) to HTML.

positional arguments:
  file.cmd       Name of CMD file to be converted. Abbreviate as `file` or
                 `file.` for increased productivity. Omit to convert all CMD
                 files under the working directory.

optional arguments:
  -h, --help     show this help message and exit
  -v, --version  show program's version number and exit
  -x, --verbose  run in verbose mode (prints every replacement applied)
</code></pre>
</li>
</ol>
<h3 id="windows-command-prompt"><a href="#windows-command-prompt" class="permalink" aria-label="Permalink"></a>Windows Command Prompt</h3>
<ol>
<li>
Add the folder containing <code>cmd.py</code> to the <code>%PATH%</code> variable
</li>
<li>
Invoke <code>cmd.py</code> to convert a CMD file to HTML:
<pre><code>&gt; cmd.py [-h] [-v] [-x] [file.cmd]

Convert Conway-Markdown (CMD) to HTML.

positional arguments:
  file.cmd       Name of CMD file to be converted. Abbreviate as `file` or
                 `file.` for increased productivity. Omit to convert all CMD
                 files under the working directory.

optional arguments:
  -h, --help     show this help message and exit
  -v, --version  show program's version number and exit
  -x, --verbose  run in verbose mode (prints every replacement applied)
</code></pre>
</li>
</ol>
<p>
<strong>WARNING: on Windows, be careful not to run any <code>.cmd</code> files by accident;
they might break your computer. God save!</strong>
</p>
<h2 id="authoring-cmd-files"><a href="#authoring-cmd-files" class="permalink" aria-label="Permalink"></a>Authoring CMD files</h2>
<p>
CMD files are parsed thus:
</p>
<pre class="cmd"><code><b class="cmdr">«replacement rules»</b>
«delimiter»
<b class="cmdc">«main content»</b>
</code></pre>
<ul>
<li>
<b><code class="cmd cmdr">«replacement rules»</code></b> are user-defined CMD replacement rules
that will be used in addition to the standard CMD replacement rules.
</li>
<li>
<code class="cmd">«delimiter»</code> is the first occurrence of
3-or-more percent signs on its own line.
(If no <code class="cmd">«delimiter»</code> is found in the file,
the whole file is parsed as <code class="cmd cmdc">«main content»</code>.)
</li>
<li>
<b><code class="cmd cmdc">«main content»</code></b> is the CMD content
that will be converted to HTML according to
the standard and user-defined CMD replacement rules.
</li>
</ul>
<p>
In the implementation:
</p>
<ol>
<li>
An empty <b>replacement queue</b> is initialised.
</li>
<li>
<b><code>STANDARD_RULES</code></b> in <a href="https://github.com/conway-markdown/conway-markdown/blob/master/cmd.py"><code>cmd.py</code></a> are parsed,
and CMD replacement rules are added to the replacement queue accordingly.
</li>
<li>
<b><code class="cmd cmdr">«replacement rules»</code></b> in the CMD file are parsed,
and CMD replacement rules are added or inserted into the replacement queue
accordingly.
</li>
<li>
The CMD replacement rules in the replacement queue are
<b>applied sequentially to <code class="cmd cmdc">«main content»</code></b>
to convert it to HTML.
</li>
</ol>
<p>
To get started with writing <b><code class="cmd cmdc">«main content»</code></b>,
read the listing of <a href="#standard-rules">standard CMD replacement rules</a>.
</p>
<p>
To learn about writing user-defined <b><code class="cmd cmdr">«replacement rules»</code></b>,
read about <a href="#replacement-rule-syntax">CMD replacement rule syntax</a>.
</p>
<h2 id="standard-rules"><a href="#standard-rules" class="permalink" aria-label="Permalink"></a>Standard CMD replacement rules</h2>
<p>
These section lists standard CMD replacement rules
as defined by the constant string <b><code>STANDARD_RULES</code></b> in <a href="https://github.com/conway-markdown/conway-markdown/blob/master/cmd.py"><code>cmd.py</code></a>.
</p>
<p>
Some replacement rules are <a href="#standard-queued-replacements">queued</a>,
in that they appear explicitly in the replacement queue.
</p>
<p>
Other replacement rules are <a href="#standard-unqueued-replacements">unqueued</a>,
in that they do not appear explicitly in the replacement queue.
However, they might be called by queued replacements.
</p>
<h3 id="standard-queued-replacements"><a href="#standard-queued-replacements" class="permalink" aria-label="Permalink"></a>Standard queued replacements</h3>
<h4 id="placeholder-markers"><a href="#placeholder-markers" class="permalink" aria-label="Permalink"></a>0. <code>#placeholder-markers</code></h4>
<details>
<summary>Definition</summary>
<pre class="cmd cmdr"><code>PlaceholderMarkerReplacement: #placeholder-markers
- queue_position: ROOT
</code></pre>
</details>
<details open>
<summary>Description</summary>
<p>
Replaces occurrences of the placeholder marker <code>«U+F8FF»</code>
with a <a href="#cmd-placeholders">placeholder</a>
so that the occurrences will not be confounding.
</p>
</details>
<h4 id="literals"><a href="#literals" class="permalink" aria-label="Permalink"></a>1. <code>#literals</code></h4>
<details>
<summary>Definition</summary>
<pre class="cmd cmdr"><code>ExtensibleFenceReplacement: #literals
- queue_position: AFTER #placeholder-markers
- syntax_type: INLINE
- allowed_flags:
    u=KEEP_HTML_UNESCAPED
    i=KEEP_INDENTED
    w=REDUCE_WHITESPACE
- prologue_delimiter: &lt;
- extensible_delimiter: `
- content_replacements:
    #escape-html
    #de-indent
    #trim-whitespace
    #reduce-whitespace
    #placeholder-protect
- epilogue_delimiter: &gt;
</code></pre>
</details>
<details open>
<summary>Description</summary>
<p>
Preserves content literally.
</p>
</details>
<details open>
<summary>Syntax</summary>
<pre class="cmd cmdc"><code>«flags»<b>&lt;</b><b>` </b>«content»<b> `</b><b>&gt;</b>
</code></pre>
<ul>
<li>
Allowed <code class="cmd cmdc">«flags»</code>:
<ul>
<li>
<code class="cmd cmdc">u</code>: keep HTML unescaped (do not apply <a href="#escape-html"><code>#escape-html</code></a>)
</li>
<li>
<code class="cmd cmdc">t</code>: keep indented (do not apply <a href="#de-indent"><code>#de-indent</code></a>)
</li>
<li>
<code class="cmd cmdc">w</code>: reduce whitespace (apply <a href="#reduce-whitespace"><code>#reduce-whitespace</code></a>)
</li>
</ul>
</li>
<li>
The number of backticks may be increased arbitrarily.
</li>
</ul>
</details>
<details open>
<summary>Examples</summary>
<ol>
<li>
Write a literal string:
<ul>
<li>
CMD: <code class="cmd cmdc">&lt;` &lt;b&gt;Foo&lt;/b&gt; `&gt;</code>
</li>
<li>
HTML: <code class="html">&amp;lt;b&amp;gt;Foo&amp;lt;/b&amp;gt;</code>
</li>
<li>
Rendered: &lt;b&gt;Foo&lt;/b&gt;
</li>
</ul>
</li>
<li>
Keep HTML unescaped:
<ul>
<li>
CMD: <code class="cmd cmdc">u&lt;` &lt;b&gt;Foo&lt;/b&gt; `&gt;</code>
</li>
<li>
HTML: <code class="html">&lt;b&gt;Foo&lt;/b&gt;</code>
</li>
<li>
Rendered: <b>Foo</b>
</li>
</ul>
</li>
<li>
Increase the number of backticks to include content
that matches the <code>#literals</code> syntax itself:
<ul>
<li>
CMD: <code class="cmd cmdc">&lt;`` Literally &lt;`literal`&gt;. ``&gt;</code>
</li>
<li>
HTML: <code class="html">Literally &amp;lt;`literal`&amp;gt;.</code>
</li>
<li>
Rendered: Literally &lt;`literal`&gt;.
</li>
</ul>
</li>
</ol>
</details>
<h3 id="standard-unqueued-replacements"><a href="#standard-unqueued-replacements" class="permalink" aria-label="Permalink"></a>Standard unqueued replacements</h3>
<h4 id="placeholder-protect"><a href="#placeholder-protect" class="permalink" aria-label="Permalink"></a><code>#placeholder-protect</code></h4>
<details>
<summary>Definition</summary>
<pre class="cmd cmdr"><code>PlaceholderProtectionReplacement: #placeholder-protect
</code></pre>
</details>
<details open>
<summary>Description</summary>
<p>
Protects a string with a <a href="#cmd-placeholders">placeholder</a>.
</p>
</details>
<details>
<summary>Dependants</summary>
<ul>
<li>
<a href="#literals"><code>#literals</code></a>
</li>
<li>
[<code>#display-code</code>]
</li>
<li>
[<code>#inline-code</code>]
</li>
<li>
[<code>#cmd-properties</code>]
</li>
<li>
[<code>#boilerplate-protect</code>]
</li>
<li>
[<code>#backslash-escapes</code>]
</li>
<li>
[<code>#angle-bracket-wrap</code>]
</li>
</ul>
</details>
<h4 id="de-indent"><a href="#de-indent" class="permalink" aria-label="Permalink"></a><code>#de-indent</code></h4>
<details>
<summary>Definition</summary>
<pre class="cmd cmdr"><code>DeIndentationReplacement: #de-indent
- negative_flag: KEEP_INDENTED
</code></pre>
</details>
<details open>
<summary>Description</summary>
<p>
Removes the longest common indentation in a string.
</p>
</details>
<details>
<summary>Dependants</summary>
<ul>
<li>
<a href="#literals"><code>#literals</code></a>
</li>
<li>
[<code>#display-code</code>]
</li>
<li>
[<code>#inline-code</code>]
</li>
</ul>
</details>
<h4 id="escape-html"><a href="#escape-html" class="permalink" aria-label="Permalink"></a><code>#escape-html</code></h4>
<details>
<summary>Definition</summary>
<pre class="cmd cmdr"><code>OrdinaryDictionaryReplacement: #escape-html
- negative_flag: KEEP_HTML_UNESCAPED
- apply_mode: SIMULTANEOUS
* &amp; --&gt; &amp;amp;
* &lt; --&gt; &amp;lt;
* &gt; --&gt; &amp;gt;
</code></pre>
</details>
<details open>
<summary>Description</summary>
<p>
Escapes <code>&amp;</code>, <code>&lt;</code>, and <code>&gt;</code> as their respective HTML ampersand entities.
</p>
</details>
<details>
<summary>Dependants</summary>
<ul>
<li>
<a href="#literals"><code>#literals</code></a>
</li>
<li>
[<code>#display-code</code>]
</li>
<li>
[<code>#inline-code</code>]
</li>
</ul>
</details>
<h4 id="trim-whitespace"><a href="#trim-whitespace" class="permalink" aria-label="Permalink"></a><code>#trim-whitespace</code></h4>
<details>
<summary>Definition</summary>
<pre class="cmd cmdr"><code>RegexDictionaryReplacement: #trim-whitespace
* \A [\s]* --&gt;
* [\s]* \Z --&gt;
</code></pre>
</details>
<details open>
<summary>Description</summary>
<p>
Removes whitespace at the very start and very end of the string.
</p>
</details>
<details>
<summary>Dependants</summary>
<ul>
<li>
<a href="#literals"><code>#literals</code></a>
</li>
<li>
[<code>#table-headers</code>]
</li>
<li>
[<code>#table-data</code>]
</li>
<li>
[<code>#inline-code</code>]
</li>
</ul>
</details>
<h4 id="reduce-whitespace"><a href="#reduce-whitespace" class="permalink" aria-label="Permalink"></a><code>#reduce-whitespace</code></h4>
<details>
<summary>Definition</summary>
<pre class="cmd cmdr"><code>RegexDictionaryReplacement: #reduce-whitespace
- positive_flag: REDUCE_WHITESPACE
* ^ [^\S\n]+ --&gt;
* [^\S\n]+ $ --&gt;
* [\s]+ (?= &lt;br&gt; ) --&gt;
* [\n]+ --&gt; \n
</code></pre>
</details>
<details open>
<summary>Description</summary>
<ol>
<li>
Removes leading horizontal whitespace on each line.
</li>
<li>
Removes trailing horizontal whitespace on each line.
</li>
<li>
Removes whitespace before <code class="cmd cmdc">&lt;br&gt;</code>.
</li>
<li>
Collapsed multiple consecutive newlines into a single newline.
</li>
</ol>
</details>
<details>
<summary>Dependants</summary>
<ul>
<li>
<a href="#literals"><code>#literals</code></a>
</li>
<li>
[<code>#display-code</code>]
</li>
<li>
[<code>#inline-code</code>]
</li>
<li>
[<code>#boilerplate-protect</code>]
</li>
<li>
[<code>#whitespace</code>]
</li>
</ul>
</details>
<h4 id="code-tag-wrap"><a href="#code-tag-wrap" class="permalink" aria-label="Permalink"></a><code>#code-tag-wrap</code></h4>
<details>
<summary>Definition</summary>
<pre class="cmd cmdr"><code>RegexDictionaryReplacement: #code-tag-wrap
* \A --&gt; &lt;code&gt;
* \Z --&gt; &lt;/code&gt;
</code></pre>
</details>
<details open>
<summary>Description</summary>
<p>
Wraps a string in opening and closing <code>code</code> tags.
</p>
</details>
<details>
<summary>Dependants</summary>
<ul>
<li>
[<code>#display-code</code>]
</li>
</ul>
</details>
<h2 id="replacement-rule-syntax"><a href="#replacement-rule-syntax" class="permalink" aria-label="Permalink"></a>CMD replacement rule syntax</h2>
<h2 id="cmd-placeholders"><a href="#cmd-placeholders" class="permalink" aria-label="Permalink"></a>CMD placeholders</h2>
<p>
There are many instances in which the result of a replacement
should not be altered further by replacements to follow.
To protect a string from further alteration,
it is temporarily replaced by a <b>placeholder</b>
consisting of code points in the main Unicode Private Use Area.
</p>
<p>
Specifically, the placeholder for a string shall be of the following form:
</p>
<pre class="cmd cmdc"><code><b>«marker»</b><b>«run_characters»</b><b>«marker»</b>
</code></pre>
<ul>
<li>
<b><code class="cmd cmdc">«marker»</code></b> is <code>«U+F8FF»</code>.
</li>
<li>
<b><code class="cmd cmdc">«run_characters»</code></b> are between <code>«U+E000»</code> and <code>«U+E0FF»</code>
each representing a Unicode byte of the string.
</li>
</ul>
<p>
It is assumed that the user will not define replacement rules that
tamper with strings of the form
<code class="cmd cmdc">«marker»«run_characters»«marker»</code>.
</p>
<h3>Example</h3>
<ul>
<li>
Consider the string <code class="cmd cmdc">£3</code>.
</li>
<li>
Its code points are <code>U+00A3</code> and <code>U+0033</code>.
</li>
<li>
The corresponding Unicode bytes are
<code>\x<b>C2</b>\x<b>A3</b></code> and <code>\x<b>33</b></code>.
</li>
<li>
The <code class="cmd cmdc">«run_characters»</code> are therefore
<code>«U+E0<b>C2</b>»«U+E0<b>A3</b>»«U+E0<b>33</b>»</code>.
</li>
<li>
The full placeholder is therefore
<code>«U+F8FF»«U+E0<b>C2</b>»«U+E0<b>A3</b>»«U+E0<b>33</b>»«U+F8FF»</code>.
</li>
</ul>
<h2 id="cmd-attribute-specifications"><a href="#cmd-attribute-specifications" class="permalink" aria-label="Permalink"></a>CMD attribute specifications</h2>
<p>
When a CMD replacement rule is defined with
<code class="cmd cmdr">attribute_specifications</code> not equal to <code class="cmd cmdr">NONE</code>,
it allows HTML attributes to be specified by <b>CMD attribute specifications</b>
enclosed in curly brackets.
</p>
<p>
CMD attribute specifications may be of the following forms:
</p>
<pre class="cmd cmdc"><code>«name»<b>=</b>"«quoted value (whitespace allowed)»"
«name»<b>=</b>«bare-value»
<b>#</b>«id»
<b>.</b>«class»
<b>r</b>«rowspan»
<b>c</b>«colspan»
<b>w</b>«width»
<b>h</b>«height»
<b>-</b>«delete-name»
«boolean-name»
</code></pre>
<p>
In the two forms with an explicit equals sign,
the following abbreviations are allowed for <code class="cmd cmdc">«name»</code>:
</p>
<ul>
<li>
<code class="cmd cmdc">#</code> for <code class="cmd cmdc">id</code>
</li>
<li>
<code class="cmd cmdc">.</code> for <code class="cmd cmdc">class</code>
</li>
<li>
<code class="cmd cmdc">l</code> for <code class="cmd cmdc">lang</code>
</li>
<li>
<code class="cmd cmdc">r</code> for <code class="cmd cmdc">rowspan</code>
</li>
<li>
<code class="cmd cmdc">c</code> for <code class="cmd cmdc">colspan</code>
</li>
<li>
<code class="cmd cmdc">w</code> for <code class="cmd cmdc">width</code>
</li>
<li>
<code class="cmd cmdc">h</code> for <code class="cmd cmdc">height</code>
</li>
<li>
<code class="cmd cmdc">s</code> for <code class="cmd cmdc">style</code>
</li>
</ul>
<h3>Examples</h3>
<ol>
<li>
Behaviour for the standard rule <code class="cmd cmdr">#inline-code</code>:
<ul>
<li>
CMD: <code class="cmd cmdc">`{#foo .bar l=en-AU title="baz"} test`</code>
</li>
<li>
HTML: <code class="html">&lt;code id="foo" class="bar" lang="en-AU" title="baz"&gt;test&lt;/code&gt;</code>
</li>
</ul>
</li>
<li>
Empty attribute specifications:
<ul>
<li>
CMD: <code class="cmd cmdc">`{} test`</code>
</li>
<li>
HTML: <code class="html">&lt;code&gt;test&lt;/code&gt;</code>
</li>
</ul>
</li>
<li>
Non-<code>class</code> values will supersede earlier ones:
<ul>
<li>
CMD: <code class="cmd cmdc">`{#1 #2 title=A title=B} test`</code>
</li>
<li>
HTML: <code class="html">&lt;code id="2" title="B"&gt;test&lt;/code&gt;</code>
</li>
</ul>
</li>
<li>
<code>class</code> values will accumulate:
<ul>
<li>
CMD: <code class="cmd cmdc">`{.a .b class=c .d} test`</code>
</li>
<li>
HTML: <code class="html">&lt;code class="a b c d"&gt;test&lt;/code&gt;</code>
</li>
</ul>
</li>
<li>
Delete <code>class</code> to reset it:
<ul>
<li>
CMD: <code class="cmd cmdc">`{.a .b -class class=c .d} test`</code>
</li>
<li>
HTML: <code class="html">&lt;code class="c d"&gt;test&lt;/code&gt;</code>
</li>
</ul>
</li>
</ol>
<h2 id="repository-links"><a href="#repository-links" class="permalink" aria-label="Permalink"></a>Repository links</h2>
<ul>
<li>
This page's CMD: <a href="https://github.com/conway-markdown/conway-markdown.github.io/blob/master/index.cmd">index.cmd</a>
</li>
<li>
This page's HTML: <a href="https://github.com/conway-markdown/conway-markdown.github.io/blob/master/index.html">index.html</a>
</li>
<li>
This page's repository: <a href="https://github.com/conway-markdown/conway-markdown.github.io/">conway-markdown.github.io</a>
</li>
<li>
Python implementation's repository: <a href="https://github.com/conway-markdown/conway-markdown">conway-markdown</a>
</li>
</ul>
<footer class="page-properties">
First created: 2020-04-05<br>
Last modified: 2022-04-30<br>
</footer>
</body>
</html>
