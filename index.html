<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="author" content="Conway">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/cmd.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
let elements = document.getElementsByClassName("js-maths");
for (let i = 0; i < elements.length; i++) {
let element = elements[i]
katex.render(
element.textContent,
element,
{displayMode: element.tagName =="DIV"}
);
}
})
</script>
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#7000ff">
<meta name="msapplication-TileColor" content="#00aba9">
<meta name="theme-color" content="#ffffff">
<title>Conway's markdown (CMD)</title>
</head>
<body>
<h1>Conway's markdown (CMD)</h1>
<div class="page-properties">
First created: 2020-04-05<br>
Last modified: 2020-07-19
</div>
<ul>
<li>This page's source CMD: <a href="https://github.com/conway-markdown/conway-markdown.github.io/blob/master/index.cmd" title="GitHub: index.cmd">index.cmd</a>
</li>
<li>This page's output HTML: <a href="https://github.com/conway-markdown/conway-markdown.github.io/blob/master/index.html" title="GitHub: index.html">index.html</a>
</li>
<li>GitHub repositories:
<a href="https://github.com/conway-markdown/conway-markdown/" title="GitHub: Conway's markdown">conway-markdown</a>,
<a href="https://github.com/conway-markdown/conway-markdown.github.io/" title="GitHub: Documentation for Conway's markdown (GitHub pages)">conway-markdown.github.io</a>
</li>
</ul>
<p>
Conway's fence-style markdown,
implemented in Python&nbsp;3.6+ using regex replacements.
</p>
<p>
Conway's markdown (CMD) is the result of someone joking that
"the filenames would look like Windows executables from the 90s".
Inspired by the backticks of John Gruber's <a href="https://daringfireball.net/projects/markdown/" title="Daring Fireball: Markdown">markdown</a>,
CMD uses fence-style constructs
where an <span class="repeatable-delimiter">arbitrarily repeatable delimiter symbol</span>
is used to wrap shorter runs of that symbol.
</p>
<p>
While markdown is really an excellent syntax,
there are many things which I've always wanted to do in markdown,
which I can't without some sort of extension
(or falling back to writing plain HTML):
</p>
<ol>
<li>Set the width of <a href="#images">images</a>
</li>
<li>Add <a href="#attribute-specifications"><code>id</code> and <code>class</code></a> to elements
</li>
<li>Write <a href="#cmd-literals">arbitrary text</a> outside of code elements
without using backslash escapes or HTML (ampersand) entities
</li>
<li><a href="#inclusions">Include</a> markdown from another file (e.g.&nbsp;a template)
</li>
<li>Use <a href="#inline-semantics"><code>&lt;b&gt;</code> and <code>&lt;i&gt;</code> elements</a>,
not just <code>&lt;strong&gt;</code> and <code>&lt;em&gt;</code>
</li>
<li>Use <a href="#blocks"><code>&lt;div&gt;</code> elements</a> without falling back to HTML
</li>
<li><a href="#regex-replacements">Define my own syntax</a> as I go.
</li>
</ol>
<p>
CMD addresses each of these.
</p>
<h2 id="installation"><a class="permalink" href="#installation" aria-label="Permalink"></a>Installation</h2>
<p>
Since this is just a crappy, single-file regex converter,
there is no plan on turning it into a proper Python package any time soon.
In the meantime:
</p>
<pre><code>$ cd some-directory/
$ git clone https://github.com/conway-markdown/conway-markdown.git
</code></pre>
<ul>
<li>If you are using Linux or Mac,
make an alias for <code>some-directory/conway-markdown/cmd.py</code> and invoke that.
</li>
<li>If you are using Windows,
add <code>some-directory</code> to the <code>%PATH%</code> variable and invoke <code>cmd.py</code>.
</li>
</ul>
<h2 id="usage"><a class="permalink" href="#usage" aria-label="Permalink"></a>Usage</h2>
<p>
Convert a CMD file to HTML, outputting to <code>cmd_name.html</code>:
</p>
<pre><code>$ cmd.py [cmd_name[.[cmd]]]
</code></pre>
<p>
Omit <code>[cmd_name[.[cmd]]]</code> to convert all CMD files
in the current directory (at all levels),
except those listed in <code>.cmdignore</code>.
</p>
<h2 id="syntax"><a class="permalink" href="#syntax" aria-label="Permalink"></a>Syntax</h2>
<p>
Since CMD-to-HTML conversion is merely a bunch of regex replacements
with some dictionaries for temporary storage of strings,
the syntax for earlier replacements will have higher precedence
than that for later replacements.
The syntax of CMD, in the order of processing, is thus:
</p>
<ul>
<li><a href="#cmd-literals">CMD literals <code>~~ ~~</code></a>
</li>
<li><a href="#display-code">Display code <code>``↵ ↵``</code></a>
</li>
<li><a href="#inline-code">Inline code <code>` `</code></a>
</li>
<li><a href="#comments">Comments <code>&lt;# #&gt;</code></a>
</li>
<li><a href="#display-maths">Display maths <code>$$↵ ↵$$</code></a>
</li>
<li><a href="#inline-maths">Inline maths <code>$ $</code></a>
</li>
<li><a href="#inclusions">Inclusions <code>{+ +}</code></a>
</li>
<li><a href="#regex-replacements">Regex replacement definitions <code>{% % %}</code></a>
</li>
<li><a href="#ordinary-replacements">Ordinary replacement definitions <code>{: : :}</code></a>
</li>
<li><a href="#preamble">Preamble <code>%%↵ ↵%%</code></a>
</li>
<li><a href="#blocks">Blocks <code>----↵ ↵----</code> etc.</a>
<ul>
<li><a href="#list-items">List items <code>*</code>, <code>+</code>, <code>-</code>, <code>1.</code></a>
</li>
</ul>
</li>
<li><a href="#tables">Tables <code>''''↵ ↵''''</code></a>
<ul>
<li><a href="#table-cells">Table cells <code>;</code> <code>,</code></a>
</li>
<li><a href="#table-rows">Table rows <code>==</code></a>
</li>
<li><a href="#table-parts">Table parts <code>|^</code>, <code>|:</code>, <code>|_</code></a>
</li>
</ul>
</li>
<li><a href="#escapes">Escapes <code>\\</code> etc.</a>
</li>
<li><a href="#line-continuations">Line continuations <code>\↵</code></a>
</li>
<li><a href="#reference-definitions">Reference-style definitions <code>@[ ] @</code></a>
</li>
<li><a href="#images">Images</a>
<ul>
<li><a href="#inline-style-images">Inline-style images <code>![ ]( )</code></a>
</li>
<li><a href="#reference-style-images">Reference-style images <code>![ ][ ]</code></a>
</li>
</ul>
</li>
<li><a href="#links">Links</a>
<ul>
<li><a href="#inline-style-links">Inline-style links <code>[ ]( )</code></a>
</li>
<li><a href="#reference-style-links">Reference-style links <code>[ ][ ]</code></a>
</li>
</ul>
</li>
<li><a href="#headings">Headings <code># #</code></a>
</li>
<li><a href="#inline-semantics">Inline semantics <code>* *</code>, <code>** **</code>, <code>_ _</code>, <code>__ __</code></a>
</li>
<li><a href="#whitespace">Whitespace</a>
</li>
</ul>
<h3 id="attribute-specifications"><a class="permalink" href="#attribute-specifications" aria-label="Permalink"></a>Attribute specifications</h3>
<p>
Most CMD syntaxes have an optional curly-bracketed part
which allows for the specification of attributes.
The following forms are recognised:
</p>
<pre class="cmd syntax"><code>#<span class="mandatory-argument">&lt;ID&gt;</span>
.<span class="mandatory-argument">&lt;CLASS&gt;</span>
r<span class="mandatory-argument">&lt;ROWSPAN&gt;</span>
c<span class="mandatory-argument">&lt;COLSPAN&gt;</span>
w<span class="mandatory-argument">&lt;WIDTH&gt;</span></code></pre>
<p>
Unrecognised forms are ignored.
If the class attribute is specified more than once,
the new value is appended to the existing values.
If a non-class attribute is specified more than once,
the latest specification shall prevail.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>||||{#first .hot #second .cold}
  Blah
||||
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;div id="second" class="hot cold"&gt;
Blah
&lt;/div&gt;
</code></pre>
</li>
</ul>
<p>
CMD attribute specifications are inspired
by <a href="https://kramdown.gettalong.org/syntax#inline-attribute-lists">kramdown's inline attribute lists</a>.
</p>
<h3 id="cmd-literals"><a class="permalink" href="#cmd-literals" aria-label="Permalink"></a>CMD literals</h3>
<pre class="cmd syntax"><code><span class="optional-argument">&lt;flags&gt;</span><span class="repeatable-delimiter">~~</span> <span class="mandatory-argument">&lt;CONTENT&gt;</span> <span class="repeatable-delimiter">~~</span></code></pre>
<p>
Produces <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> literally,
with HTML syntax-character escaping and de-indentation.
Whitespace around <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is stripped.
<code><span class="optional-argument">&lt;flags&gt;</span></code> may consist of zero or more of the following characters:
</p>
<ul>
<li><code>u</code> to leave HTML syntax characters unescaped
</li>
<li><code>c</code> to process <a href="#line-continuations">line continuations</a>
</li>
<li><code>w</code> to process <a href="#whitespace">whitespace</a> completely
</li>
<li><code>a</code> to enable all flags above
</li>
</ul>
<p>
For <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> containing two or more consecutive tildes,
use a longer run of <span class="repeatable-delimiter">tildes</span> in the delimiters.
</p>
<p>
A good use case is to wrap <code>&lt;script&gt;</code> elements inside <code>u~~ ~~</code>.
This makes it immune to all CMD processing
(e.g.&nbsp;conversion of <code>* *</code> to <code>&lt;em&gt; &lt;/em&gt;</code>).
</p>
<h4 id="cmd-literals-basic"><a class="permalink" href="#cmd-literals-basic" aria-label="Permalink"></a>Example 1: basic usage</h4>
<ul>
<li>CMD
<pre class="cmd"><code>Escaping: ~~ &amp; &lt; &gt; ~~.
Whitespace stripping: {~~      yes      ~~}.
Enough tildes: ~~~~ ~~~ ~~ never ~~ ~~~ ~~~~.
</code></pre>
</li>
<li>HTML
<pre class="html"><code>Escaping: &amp;amp; &amp;lt; &amp;gt;.
Whitespace stripping: {yes}.
Enough tildes: ~~~ ~~ never ~~ ~~~.
</code></pre>
</li>
<li>Rendered
<p>
Escaping: &amp; &lt; &gt;.
Whitespace stripping: {yes}.
Enough tildes: ~~~ ~~ never ~~ ~~~.
</p>
</li>
</ul>
<h4 id="flags"><a class="permalink" href="#flags" aria-label="Permalink"></a>Example 2: flags</h4>
<h5 id="unescaped-flag"><a class="permalink" href="#unescaped-flag" aria-label="Permalink"></a>2.1&nbsp;Unescaped flag <code>u</code></h5>
<ul>
<li>CMD
<pre class="cmd"><code>Escaping:     ~~ &lt;b&gt;blah&lt;/b&gt; ~~.
No escaping: u~~ &lt;b&gt;cough&lt;/b&gt; ~~.
</code></pre>
</li>
<li>HTML
<pre class="html"><code>Escaping:     &amp;lt;b&amp;gt;blah&amp;lt;/b&amp;gt;.
No escaping: &lt;b&gt;cough&lt;/b&gt;.
</code></pre>
</li>
<li>Rendered
<p>
Escaping:     &lt;b&gt;blah&lt;/b&gt;.
No escaping: <b>cough</b>.
</p>
</li>
</ul>
<h5 id="continuations-flag"><a class="permalink" href="#continuations-flag" aria-label="Permalink"></a>2.2&nbsp;Continuations flag <code>c</code></h5>
<ul>
<li>CMD
<pre class="cmd"><code>uc~~
  &lt;pre&gt;
    Blah blah blah\
      Cough cough cough
        Yep yep yep
  &lt;/pre&gt;
~~
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;pre&gt;
  Blah blah blahCough cough cough
      Yep yep yep
&lt;/pre&gt;
</code></pre>
</li>
<li>Rendered
<pre>
  Blah blah blahCough cough cough
      Yep yep yep
</pre>
</li>
</ul>
<h5 id="whitespace-flag"><a class="permalink" href="#whitespace-flag" aria-label="Permalink"></a>2.3&nbsp;Whitespace flag <code>w</code></h5>
<ul>
<li>CMD
<pre class="cmd"><code>uw~~
  &lt;pre&gt;
    Blah blah blah
      Cough cough cough
        Yep yep yep
  &lt;/pre&gt;
~~
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;pre&gt;
Blah blah blah
Cough cough cough
Yep yep yep
&lt;/pre&gt;
</code></pre>
</li>
<li>Rendered
<pre>
Blah blah blah
Cough cough cough
Yep yep yep
</pre>
</li>
</ul>
<h3 id="display-code"><a class="permalink" href="#display-code" aria-label="Permalink"></a>Display code</h3>
<pre class="cmd syntax"><code><span class="optional-argument">&lt;flags&gt;</span><span class="repeatable-delimiter">``</span>{<span class="optional-argument">&lt;attribute specification&gt;</span>}
  <span class="mandatory-argument">&lt;CONTENT&gt;</span>
<span class="repeatable-delimiter">``</span></code></pre>
<p>
If <code><span class="optional-argument">&lt;attribute specification&gt;</span></code> is empty,
the curly brackets surrounding it may be omitted.
</p>
<p>
Produces the display code
<code>&lt;pre<span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span>&gt;&lt;code&gt;<span class="mandatory-argument">&lt;CONTENT&gt;</span>&lt;/code&gt;&lt;/pre&gt;</code>
where <code><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span></code> is the sequence of attributes
<a href="#attribute-specifications">built from <code><span class="optional-argument">&lt;attribute specification&gt;</span></code></a>,
with HTML syntax-character escaping
and de-indentation for <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code>.
<code><span class="optional-argument">&lt;flags&gt;</span></code> may consist of zero or more of the following characters
(see <a href="#flags">flags examples</a>):
</p>
<ul>
<li><code>u</code> to leave HTML syntax characters unescaped
</li>
<li><code>c</code> to process <a href="#line-continuations">line continuations</a>
</li>
<li><code>w</code> to process <a href="#whitespace">whitespace</a> completely
</li>
<li><code>a</code> to enable all flags above
</li>
</ul>
<p>
For <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> containing two or more consecutive backticks,
use a longer run of <span class="repeatable-delimiter">backticks</span> in the delimiters.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>``{#id-0 .class-1 .class-2}
    Escaping: &amp; &lt; &gt;.
    Note that CMD literals have higher precedence,
    since they are processed first: ~~~ ~~ literally ~~ ~~~.
        Uniform
        de-indentation:
        yes.
``
````
  ``
  Use more backticks as required.
  If &lt;id&gt; and &lt;class&gt; are omitted,
  no corresponding attributes are generated.
  ``
````
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;pre id="id-0" class="class-1 class-2"&gt;&lt;code&gt;Escaping: &amp;amp; &amp;lt; &amp;gt;.
Note that CMD literals have higher precedence,
since they are processed first: ~~ literally ~~.
    Uniform
    de-indentation:
    yes.
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;``
Use more backticks as required.
If &amp;lt;id&amp;gt; and &amp;lt;class&amp;gt; are omitted,
no corresponding attributes are generated.
``
&lt;/code&gt;&lt;/pre&gt;
</code></pre>
</li>
<li>Rendered
<pre id="id-0" class="class-1 class-2"><code>Escaping: &amp; &lt; &gt;.
Note that CMD literals have higher precedence,
since they are processed first: ~~ literally ~~.
    Uniform
    de-indentation:
    yes.
</code></pre>
<pre><code>``
Use more backticks as required.
If &lt;id&gt; and &lt;class&gt; are omitted,
no corresponding attributes are generated.
``
</code></pre>
</li>
</ul>
<h3 id="inline-code"><a class="permalink" href="#inline-code" aria-label="Permalink"></a>Inline code</h3>
<pre class="cmd syntax"><code><span class="optional-argument">&lt;flags&gt;</span><span class="repeatable-delimiter">`</span> <span class="mandatory-argument">&lt;CONTENT&gt;</span> <span class="repeatable-delimiter">`</span></code></pre>
<p>
Produces the inline code
<code>&lt;code&gt;<span class="mandatory-argument">&lt;CONTENT&gt;</span>&lt;/code&gt;</code>,
with HTML syntax-character escaping
and de-indentation for <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code>.
Whitespace around <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is stripped.
<code><span class="optional-argument">&lt;flags&gt;</span></code> may consist of zero or more of the following characters
(see <a href="#flags">flags examples</a>):
</p>
<ul>
<li><code>u</code> to leave HTML syntax characters unescaped
</li>
<li><code>c</code> to process <a href="#line-continuations">line continuations</a>
</li>
<li><code>w</code> to process <a href="#whitespace">whitespace</a> completely
</li>
<li><code>a</code> to enable all flags above
</li>
</ul>
<p>
For <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> containing one or more consecutive backticks
which are not protected by <a href="#cmd-literals">CMD literals</a>,
use a longer run of <span class="repeatable-delimiter">backticks</span> in the delimiters.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>`` The escaped form of &amp; is &amp;amp;. Here is a tilde: `. ``
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;code&gt;The escaped form of &amp;amp; is &amp;amp;amp;. Here is a tilde: `.&lt;/code&gt;
</code></pre>
</li>
<li>Rendered
<p>
<code>The escaped form of &amp; is &amp;amp;. Here is a tilde: `.</code>
</p>
</li>
</ul>
<h3 id="comments"><a class="permalink" href="#comments" aria-label="Permalink"></a>Comments</h3>
<pre class="cmd syntax"><code>&lt;<span class="repeatable-delimiter">#</span> <span class="mandatory-argument">&lt;COMMENT&gt;</span> <span class="repeatable-delimiter">#</span>&gt;</code></pre>
<p>
Removed, along with any preceding horizontal whitespace.
For <code><span class="mandatory-argument">&lt;COMMENT&gt;</span></code> containing one or more consecutive hashes
followed by a closing angle bracket,
use a longer run of <span class="repeatable-delimiter">hashes</span> in the delimiters.
</p>
<p>
Although comments are weaker than literals and code
they may still be used to remove them.
For instance <code>~~ A &lt;# B #&gt; ~~</code> becomes <code>A &lt;# B #&gt;</code>,
whereas <code>&lt;# A ~~ B ~~ #&gt;</code> is removed entirely.
In this sense they are stronger than literals and code.
</p>
<h3 id="display-maths"><a class="permalink" href="#display-maths" aria-label="Permalink"></a>Display maths</h3>
<pre class="cmd syntax"><code><span class="optional-argument">&lt;flags&gt;</span><span class="repeatable-delimiter">$$</span>{<span class="optional-argument">&lt;attribute specification&gt;</span>}
  <span class="mandatory-argument">&lt;CONTENT&gt;</span>
<span class="repeatable-delimiter">$$</span></code></pre>
<p>
If <code><span class="optional-argument">&lt;attribute specification&gt;</span></code> is empty,
the curly brackets surrounding it may be omitted.
</p>
<p>
Produces
<code>&lt;div<span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span>&gt;<span class="mandatory-argument">&lt;CONTENT&gt;</span>&lt;/div&gt;</code>
where <code><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span></code> is the sequence of attributes
built from <code><span class="optional-argument">&lt;attribute specification&gt;</span></code> with <code>.js-maths</code> prepended,
with HTML syntax-character escaping
and de-indentation for <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code>.
<code><span class="optional-argument">&lt;flags&gt;</span></code> may consist of zero or more of the following characters
(see <a href="#whitespace-flag">whitespace flag example</a>):
</p>
<ul>
<li><code>w</code> to process <a href="#whitespace">whitespace</a> completely
</li>
</ul>
<p>
For <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> containing two or more consecutive dollar signs
which are not protected by <a href="#cmd-literals">CMD literals</a>,
use a longer run of <span class="repeatable-delimiter">dollar signs</span> in the delimiters.
</p>
<p>
This is to be used with some sort of JavaScript code
which renders equations based on the class <code>js-maths</code>.
On this page I am using <a href="https://katex.org/" title="KaTeX — The fastest math typesetting library for the web">KaTeX</a>.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>$$
  1 + \frac{1}{2^2} + \frac{1}{3^2} + \dots
    = \frac{\pi^2}{6}
    &lt; 2
$$
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;div class="js-maths"&gt;1 + \frac{1}{2^2} + \frac{1}{3^2} + \dots
  = \frac{\pi^2}{6}
  &amp;lt; 2
&lt;/div&gt;
</code></pre>
</li>
<li>Rendered
<div class="js-maths">1 + \frac{1}{2^2} + \frac{1}{3^2} + \dots
  = \frac{\pi^2}{6}
  &lt; 2
</div>
</li>
</ul>
<h3 id="inline-maths"><a class="permalink" href="#inline-maths" aria-label="Permalink"></a>Inline maths</h3>
<pre class="cmd syntax"><code><span class="optional-argument">&lt;flags&gt;</span><span class="repeatable-delimiter">$</span> <span class="mandatory-argument">&lt;CONTENT&gt;</span> <span class="repeatable-delimiter">$</span></code></pre>
<p>
Produces
<code>&lt;span class="js-maths"&gt;<span class="mandatory-argument">&lt;CONTENT&gt;</span>&lt;/span&gt;</code>,
with HTML syntax-character escaping for <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code>.
Whitespace around <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is stripped.
<code><span class="optional-argument">&lt;flags&gt;</span></code> may consist of zero or more of the following characters
(see <a href="#whitespace-flag">whitespace flag example</a>):
</p>
<ul>
<li><code>w</code> to process <a href="#whitespace">whitespace</a> completely
</li>
</ul>
<p>
For <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> containing one or more consecutive dollar signs
which are not protected by <a href="#cmd-literals">CMD literals</a>,
use a longer run of <span class="repeatable-delimiter">dollar signs</span> in the delimiters.
</p>
<p>
This is to be used with some sort of JavaScript code
which renders equations based on the class <code>js-maths</code>.
On this page I am using <a href="https://katex.org/" title="KaTeX — The fastest math typesetting library for the web">KaTeX</a>.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>A contrived instance of multiple dollar signs in inline maths:
$$$ \text{Yea, \$$d$ means $d$~dollars.} $$$
</code></pre>
</li>
<li>HTML
<pre class="html"><code>A contrived instance of multiple dollar signs in inline maths:
&lt;span class="js-maths"&gt;\text{Yea, \$$d$ means $d$~dollars.}&lt;/span&gt;
</code></pre>
</li>
<li>Rendered
<p>
A contrived instance of multiple dollar signs in inline maths:
<span class="js-maths">\text{Yea, \$$d$ means $d$~dollars.}</span>
</p>
</li>
</ul>
<h3 id="inclusions"><a class="permalink" href="#inclusions" aria-label="Permalink"></a>Inclusions</h3>
<pre class="cmd syntax"><code>{<span class="repeatable-delimiter">+</span> <span class="mandatory-argument">&lt;FILE NAME&gt;</span> <span class="repeatable-delimiter">+</span>}</code></pre>
<p>
Includes the content of the file <code><span class="mandatory-argument">&lt;FILE NAME&gt;</span></code>.
For <code><span class="mandatory-argument">&lt;FILE NAME&gt;</span></code> containing one or more consecutive plus signs
followed by a closing curly bracket,
use a longer run of <span class="repeatable-delimiter">plus signs</span> in the delimiters.
</p>
<p>
All of the syntax above (CMD literals through to inline maths) is processed.
Unlike nested <code>\input</code> in LaTeX, nested inclusions are not processed.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>{+ inclusion.txt +}
</code></pre>
</li>
<li>HTML
<pre class="html"><code>This is content from &lt;a href="/inclusion.txt"&gt;&lt;code&gt;inclusion.txt&lt;/code&gt;&lt;/a&gt;.
Nested inclusions are not processed,
so there is no need to worry about recursion errors: {+ inclusion.txt +}
</code></pre>
</li>
<li>Rendered
<p>
This is content from <a href="/inclusion.txt"><code>inclusion.txt</code></a>.
Nested inclusions are not processed,
so there is no need to worry about recursion errors: {+ inclusion.txt +}
</p>
</li>
</ul>
<h3 id="regex-replacements"><a class="permalink" href="#regex-replacements" aria-label="Permalink"></a>Regex replacement definitions</h3>
<pre class="cmd syntax"><code><span class="optional-argument">&lt;flag&gt;</span>{<span class="repeatable-delimiter">%</span> <span class="mandatory-argument">&lt;PATTERN&gt;</span> <span class="repeatable-delimiter">%</span> <span class="mandatory-argument">&lt;REPLACEMENT&gt;</span> <span class="repeatable-delimiter">%</span>}</code></pre>
<p>
Regex replacement definition
for the replacement of <code><span class="mandatory-argument">&lt;PATTERN&gt;</span></code> by <code><span class="mandatory-argument">&lt;REPLACEMENT&gt;</span></code>
according to Python regex syntax,
with the flags <code>re.ASCII</code>, <code>re.MULTILINE</code>, and <code>re.VERBOSE</code> enabled.
</p>
<p>
Whitespace around <code><span class="mandatory-argument">&lt;PATTERN&gt;</span></code> and <code><span class="mandatory-argument">&lt;REPLACEMENT&gt;</span></code> is stripped.
For <code><span class="mandatory-argument">&lt;PATTERN&gt;</span></code> or <code><span class="mandatory-argument">&lt;REPLACEMENT&gt;</span></code> containing
one or more consecutive percent signs,
use a longer run of <span class="repeatable-delimiter">percent signs</span> in the delimiters.
For <code><span class="mandatory-argument">&lt;PATTERN&gt;</span></code> matching any of the syntax above,
which should not be processed using that syntax, use CMD literals.
<code><span class="optional-argument">&lt;flag&gt;</span></code> may consist of zero or one of the following characters,
and specifies when the regex replacement is to be applied:
</p>
<ul>
<li><code>A</code> for immediately after processing regex replacement definitions
</li>
<li><code>p</code> for just before processing <a href="#preamble">preamble</a>
</li>
<li><code>b</code> for just before processing <a href="#blocks">blocks</a>
</li>
<li><code>t</code> for just before processing <a href="#tables">tables</a>
</li>
<li><code>e</code> for just before processing <a href="#escapes">escapes</a>
</li>
<li><code>c</code> for just before processing <a href="#line-continuations">line continuations</a>
</li>
<li><code>r</code> for just before processing <a href="#reference-definitions">reference-style definitions</a>
</li>
<li><code>i</code> for just before processing <a href="#images">images</a>
</li>
<li><code>l</code> for just before processing <a href="#links">links</a>
</li>
<li><code>h</code> for just before processing <a href="#headings">headings</a>
</li>
<li><code>s</code> for just before processing <a href="#inline-semantics">inline semantics</a>
</li>
<li><code>w</code> for just before processing <a href="#whitespace">whitespace</a>
</li>
<li><code>Z</code> for just before replacing placeholder strings
</li>
</ul>
<p>
If <code><span class="optional-argument">&lt;flag&gt;</span></code> is empty, it defaults to <code>A</code>.
</p>
<p>
All regex replacement definitions are read and stored.
If the same pattern is specified more than once for a given flag,
the latest definition shall prevail.
</p>
<p>
As an example, the following regex replacement is used
to automatically insert the permalinks
before the section headings (<code>&lt;h2&gt;</code> to <code>&lt;h6&gt;</code>) in this page:
</p>
<pre class="cmd"><code>{%
  ^ [^\S\n]*
  (?P&lt;hashes&gt; [#]{2,6} )
    \{
      [#] (?P&lt;id_&gt; [\S]+? )
    \}
  [\s]+
    (?P&lt;content&gt; [\s\S]*? )
  (?P=hashes)
%
  \g&lt;hashes&gt;{#\g&lt;id_&gt;}
    &lt;a class="permalink" href="#\g&lt;id_&gt;" aria-label="Permalink"&gt;&lt;/a&gt;\\
    \g&lt;content&gt;
  \g&lt;hashes&gt;
%}
</code></pre>
<p>
<strong>Warning:</strong> malicious or careless user-defined regex replacements
will break the normal CMD syntax.
To avoid breaking placeholder storage
(used to protect portions of the markup from further processing),
do not use replacements to alter placeholder strings,
which are of the form <code><span class="mandatory-argument">&lt;N&gt;</span></code>,
where <code></code> is the placeholder marker <code>U+E000</code> (Private Use Area)
and <code><span class="mandatory-argument">&lt;N&gt;</span></code> is an integer.
To avoid breaking properties,
do not use replacements to alter property strings,
which are of the form <code>%<span class="mandatory-argument">&lt;PROPERTY NAME&gt;</span></code>.
</p>
<h3 id="ordinary-replacements"><a class="permalink" href="#ordinary-replacements" aria-label="Permalink"></a>Ordinary replacements</h3>
<pre class="cmd syntax"><code><span class="optional-argument">&lt;flag&gt;</span>{<span class="repeatable-delimiter">:</span> <span class="mandatory-argument">&lt;PATTERN&gt;</span> <span class="repeatable-delimiter">:</span> <span class="mandatory-argument">&lt;REPLACEMENT&gt;</span> <span class="repeatable-delimiter">:</span>}</code></pre>
<p>
Ordinary replacement definition
for the replacement of <code><span class="mandatory-argument">&lt;PATTERN&gt;</span></code> by <code><span class="mandatory-argument">&lt;REPLACEMENT&gt;</span></code>.
</p>
<p>
Whitespace around <code><span class="mandatory-argument">&lt;PATTERN&gt;</span></code> and <code><span class="mandatory-argument">&lt;REPLACEMENT&gt;</span></code> is stripped.
For <code><span class="mandatory-argument">&lt;PATTERN&gt;</span></code> or <code><span class="mandatory-argument">&lt;REPLACEMENT&gt;</span></code> containing
one or more consecutive colons,
use a longer run of <span class="repeatable-delimiter">colons</span> in the delimiters.
<code><span class="optional-argument">&lt;flag&gt;</span></code> may consist of zero or one of the following characters,
and specifies when the ordinary replacement is to be applied:
</p>
<ul>
<li><code>A</code> for immediately after processing ordinary replacement definitions
</li>
<li><code>p</code> for just before processing <a href="#preamble">preamble</a>
</li>
<li><code>b</code> for just before processing <a href="#blocks">blocks</a>
</li>
<li><code>t</code> for just before processing <a href="#tables">tables</a>
</li>
<li><code>e</code> for just before processing <a href="#escapes">escapes</a>
</li>
<li><code>c</code> for just before processing <a href="#line-continuations">line continuations</a>
</li>
<li><code>r</code> for just before processing <a href="#reference-definitions">reference-style definitions</a>
</li>
<li><code>i</code> for just before processing <a href="#images">images</a>
</li>
<li><code>l</code> for just before processing <a href="#links">links</a>
</li>
<li><code>h</code> for just before processing <a href="#headings">headings</a>
</li>
<li><code>s</code> for just before processing <a href="#inline-semantics">inline semantics</a>
</li>
<li><code>w</code> for just before processing <a href="#whitespace">whitespace</a>
</li>
<li><code>Z</code> for just before replacing placeholder strings
</li>
</ul>
<p>
If <code><span class="optional-argument">&lt;flag&gt;</span></code> is empty, it defaults to <code>A</code>.
</p>
<p>
All ordinary replacement definitions are read and stored.
If the same pattern is specified more than once for a given flag,
the latest definition shall prevail.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>{: |hup-hup| : Huzzah! :}
|hup-hup| \+

{: \def1 : Earlier specifications lose. :}
{: \def1 : Later specifications win. :}
\def1 \+

\def2 \+
{: \def2 : Specifications can be given anywhere. :}

{: &lt;out&gt; : Nesting will work provided the &lt;in&gt; is given later. :}
{: &lt;in&gt; : inner specification :}
&lt;out&gt;
</code></pre>
</li>
<li>Rendered
<p>
Huzzah!<br>
Later specifications win.<br>
Specifications can be given anywhere.<br>
Nesting will work provided the inner specification is given later.
</p>
</li>
</ul>
<p>
<strong>Warning:</strong> malicious or careless user-defined ordinary replacements
will break the normal CMD syntax.
To avoid breaking placeholder storage
(used to protect portions of the markup from further processing),
do not use replacements to alter placeholder strings,
which are of the form <code><span class="mandatory-argument">&lt;N&gt;</span></code>,
where <code></code> is the placeholder marker <code>U+E000</code> (Private Use Area)
and <code><span class="mandatory-argument">&lt;N&gt;</span></code> is an integer.
To avoid breaking properties,
do not use replacements to alter property strings,
which are of the form <code>%<span class="mandatory-argument">&lt;PROPERTY NAME&gt;</span></code>.
</p>
<h3 id="preamble"><a class="permalink" href="#preamble" aria-label="Permalink"></a>Preamble</h3>
<pre class="cmd syntax"><code><span class="repeatable-delimiter">%%</span>
  <span class="mandatory-argument">&lt;CONTENT&gt;</span>
<span class="repeatable-delimiter">%%</span></code></pre>
<p>
Processes the preamble.
<code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is split into property definitions
according to leading occurrences of <code>%<span class="mandatory-argument">&lt;PROPERTY NAME&gt;</span></code>,
where <code><span class="mandatory-argument">&lt;PROPERTY NAME&gt;</span></code> may only contain letters, digits, and hyphens.
Property definitions end at the next property definition,
or at the end of the (preamble) content being split.
Each property definition is stored and may be referenced
by writing <code>%<span class="mandatory-argument">&lt;PROPERTY NAME&gt;</span></code>,
called a property string, anywhere else in the document.
If the same property is specified more than once,
the latest definition shall prevail.
</p>
<p>
This produces the HTML preamble,
i.e.&nbsp;everything from <code>&lt;!DOCTYPE html&gt;</code> through to <code>&lt;body&gt;</code>.
</p>
<p>
For <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> containing two or more consecutive percent signs
which are not protected by CMD literals,
use a longer run of <span class="repeatable-delimiter">percent signs</span> in the delimiters.
</p>
<p>
Only the first occurrence of a preamble in the markup is processed.
</p>
<p>
The following properties, called original properties,
are accorded special treatment.
If omitted from a preamble,
they take the default values shown beside them:
</p>
<pre class="cmd"><code>%lang en
%viewport width=device-width, initial-scale=1
%title Title
%title-suffix
%author
%date-created yyyy-mm-dd
%date-modified yyyy-mm-dd
%resources
%description
%css
%onload-js
%footer-copyright-remark
%footer-remark
</code></pre>
<p>
The following properties, called derived properties,
are computed based on the supplied original properties:
</p>
<pre class="cmd"><code>%html-lang-attribute
%meta-element-author
%meta-element-description
%meta-element-viewport
%title-element
%style-element
%body-onload-attribute
%year-created
%year-modified
%year-modified-next
%footer-element
%url
%clean-url
</code></pre>
<h4 id="preamble-minimal"><a class="permalink" href="#preamble-minimal" aria-label="Permalink"></a>Example 1: a minimal HTML file</h4>
<ul>
<li>CMD
<pre class="cmd"><code>%%
%%
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="utf-8"&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
&lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</li>
</ul>
<h4 id="preamble-not-minimal"><a class="permalink" href="#preamble-not-minimal" aria-label="Permalink"></a>Example 2: a not-so-minimal HTML file</h4>
<ul>
<li>CMD
<pre class="cmd"><code>%%
  %lang en-AU
  %title My title
  %title-suffix \ | My site
  %author Me
  %date-created 2020-04-11
  %date-modified 2020-07-19
  %description
    Example CMD-to-HTML output.
  %css a~~
    #special {
      color: purple;
    }
  ~~
  %onload-js
    special.textContent += ' This is a special paragraph!'
%%

# %title #

----{#special}
  The title of this page is "%title", and the author is %author.
  At the time of writing, next year will be %year-modified-next.
----

%footer-element
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en-AU"&gt;
&lt;head&gt;
&lt;meta charset="utf-8"&gt;
&lt;meta name="author" content="Me"&gt;
&lt;meta name="description" content="Example CMD-to-HTML output."&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
&lt;title&gt;My title | My site&lt;/title&gt;
&lt;style&gt;#special {
color: purple;
}&lt;/style&gt;
&lt;/head&gt;
&lt;body onload="special.textContent += ' This is a special paragraph!'"&gt;
&lt;h1&gt;My title&lt;/h1&gt;
&lt;p id="special"&gt;
The title of this page is "My title", and the author is Me.
At the time of writing, next year will be 2021.
&lt;/p&gt;
&lt;footer&gt;
©&amp;nbsp;2020&amp;nbsp;Me.
&lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</li>
</ul>
<h3 id="blocks"><a class="permalink" href="#blocks" aria-label="Permalink"></a>Blocks</h3>
<pre class="cmd syntax"><code><span class="repeatable-delimiter">&lt;C&gt;&lt;C&gt;&lt;C&gt;&lt;C&gt;</span>{<span class="optional-argument">&lt;attribute specification&gt;</span>}
  <span class="mandatory-argument">&lt;CONTENT&gt;</span>
<span class="repeatable-delimiter">&lt;C&gt;&lt;C&gt;&lt;C&gt;&lt;C&gt;</span></code></pre>
<p>
If <code><span class="optional-argument">&lt;attribute specification&gt;</span></code> is empty,
the curly brackets surrounding it may be omitted.
</p>
<p>
Produces the block
<code>&lt;<span class="mandatory-argument">&lt;TAG NAME&gt;</span><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span>↵<span class="mandatory-argument">&lt;CONTENT&gt;</span>&lt;/<span class="mandatory-argument">&lt;TAG NAME&gt;</span>&gt;</code>,
where <code><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span></code> is the sequence of attributes
<a href="#attribute-specifications">built from <code><span class="optional-argument">&lt;attribute specification&gt;</span></code></a>.
For <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> containing four or more
consecutive delimiting characters
which are not protected by <a href="#cmd-literals">CMD literals</a>,
use a longer run of <span class="repeatable-delimiter">delimiting characters</span> in the delimiters.
</p>
<p>
The following delimiting characters <code><span class="repeatable-delimiter">&lt;C&gt;</span></code> are used:
</p>
<ul>
<li>Non-lists:
<ul>
<li><code>-</code> for <code>&lt;p&gt;</code>
</li>
<li><code>|</code> for <code>&lt;div&gt;</code>
</li>
<li><code>"</code> for <code>&lt;blockquote&gt;</code>
</li>
</ul>
</li>
<li>Lists:
<ul>
<li><code>=</code> for <code>&lt;ul&gt;</code>
</li>
<li><code>+</code> for <code>&lt;ol&gt;</code>
</li>
</ul>
</li>
</ul>
<p>
In the implementation, a recursive call is used to process nested blocks.
</p>
<h4 id="list-items"><a class="permalink" href="#list-items" aria-label="Permalink"></a>List items</h4>
<p>
For list blocks, <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is split into list items <code>&lt;li&gt;</code>
according to leading occurrences of the following:
</p>
<pre class="cmd syntax"><code>&lt;Y&gt;{<span class="optional-argument">&lt;attribute specification&gt;</span>}</code></pre>
<p>
The following delimiters <code>&lt;Y&gt;</code> for list items are used:
</p>
<ul>
<li><code>*</code>
</li>
<li><code>+</code>
</li>
<li><code>-</code>
</li>
<li><code>1.</code> (or any run of digits followed by a full stop)
</li>
</ul>
<p>
List items end at the next list item,
or at the end of the content being split.
If <code><span class="optional-argument">&lt;attribute specification&gt;</span></code> is empty,
the curly brackets surrounding it may be omitted.
</p>
<h4 id="blocks-nesting"><a class="permalink" href="#blocks-nesting" aria-label="Permalink"></a>Example 1: nesting</h4>
<ul>
<li>CMD
<pre class="cmd"><code>----
A paragraph.
----
======
* A nested unordered list:
  ====
  1. Unlike John Gruber's markdown, indentation doesn't matter.
      * This is on the same level as the item above.
  ====
* A nested ordered list:
  ++++
  * A leading asterisk `*` can be used for `&lt;li&gt;` in `&lt;ol&gt;`.
  + Also a plus sign `+`.
  - Also a hyphen `-`.
  2.  An easy way to remember the list delimiters is that
      unordered list items stay constant (`====`) while
      ordered list items increment (`++++`).
  ++++
0. A leading number and full stop can be used for `&lt;li&gt;` in `&lt;ul&gt;`.
99999999. Any non-negative integer will do.
  """"""
  Someone might quote this later. 
  ====
  * Yes, I know.
  ====
  """"""
1. They all get turned into `&lt;li&gt;` tags regardless.
======
</code></pre>
</li>
<li>Rendered
<p>
A paragraph.
</p>
<ul>
<li>A nested unordered list:
<ul>
<li>Unlike John Gruber's markdown, indentation doesn't matter.
</li>
<li>This is on the same level as the item above.
</li>
</ul>
</li>
<li>A nested ordered list:
<ol>
<li>A leading asterisk <code>*</code> can be used for <code>&lt;li&gt;</code> in <code>&lt;ol&gt;</code>.
</li>
<li>Also a plus sign <code>+</code>.
</li>
<li>Also a hyphen <code>-</code>.
</li>
<li>An easy way to remember the list delimiters is that
unordered list items stay constant (<code>====</code>) while
ordered list items increment (<code>++++</code>).
</li>
</ol>
</li>
<li>A leading number and full stop can be used for <code>&lt;li&gt;</code> in <code>&lt;ul&gt;</code>.
</li>
<li>Any non-negative integer will do.
<blockquote>
Someone might quote this later.
<ul>
<li>Yes, I know.
</li>
</ul>
</blockquote>
</li>
<li>They all get turned into <code>&lt;li&gt;</code> tags regardless.
</li>
</ul>
</li>
</ul>
<h4 id="blocks-id-class"><a class="permalink" href="#blocks-id-class" aria-label="Permalink"></a>Example 2: <code>id</code> and <code>class</code></h4>
<ul>
<li>CMD
<pre class="cmd"><code>----{#p-id .p-class}
Paragraph with `id` and `class`.
----
======
*{#li-id} List item with `id` and no `class`.
0.{.li-class} List item with `class` and no `id`.
1.{.li-class}
  Put arbitrary whitespace after the class for more clarity.
======
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;p id="p-id" class="p-class"&gt;
Paragraph with &lt;code&gt;id&lt;/code&gt; and &lt;code&gt;class&lt;/code&gt;.
&lt;/p&gt;
&lt;ul&gt;
&lt;li id="li-id"&gt;List item with &lt;code&gt;id&lt;/code&gt; and no &lt;code&gt;class&lt;/code&gt;.
&lt;/li&gt;
&lt;li class="li-class"&gt;List item with &lt;code&gt;class&lt;/code&gt; and no &lt;code&gt;id&lt;/code&gt;.
&lt;/li&gt;
&lt;li class="li-class"&gt;Put arbitrary whitespace after the class for more clarity.
&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
</li>
</ul>
<h3 id="tables"><a class="permalink" href="#tables" aria-label="Permalink"></a>Tables</h3>
<pre class="cmd syntax"><code><span class="repeatable-delimiter">''''</span>{<span class="optional-argument">&lt;attribute specification&gt;</span>}
  <span class="mandatory-argument">&lt;CONTENT&gt;</span>
<span class="repeatable-delimiter">''''</span></code></pre>
<p>
If <code><span class="optional-argument">&lt;attribute specification&gt;</span></code> is empty,
the curly brackets surrounding it may be omitted.
</p>
<p>
Produces the table
<code>&lt;table<span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span>↵<span class="mandatory-argument">&lt;CONTENT&gt;</span>&lt;/table&gt;</code>,
where <code><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span></code> is the sequence of attributes
<a href="#attribute-specifications">built from <code><span class="optional-argument">&lt;attribute specification&gt;</span></code></a>.
For <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> containing four or more apostrophes
which are not protected by <a href="#cmd-literals">CMD literals</a>,
use a longer run of <span class="repeatable-delimiter">apostrophes</span> in the delimiters.
</p>
<p>
In the implementation, a recursive call is used to process nested tables.
</p>
<p>
<code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is
</p>
<ol>
<li>split into table cells <code>&lt;th&gt;</code>, <code>&lt;td&gt;</code>
according to <a href="#table-cells">table cell processing</a>,
</li>
<li>split into table rows <code>&lt;tr&gt;</code>
according to <a href="#table-rows">table row processing</a>, and
</li>
<li>split into table parts <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, <code>&lt;tfoot&gt;</code>
according to <a href="#table-parts">table part processing</a>.
</li>
</ol>
<h4 id="table-cells"><a class="permalink" href="#table-cells" aria-label="Permalink"></a>Table cells</h4>
<p>
<code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is split into table cells <code>&lt;th&gt;</code>, <code>&lt;td&gt;</code>
according to leading occurrences of the following:
</p>
<pre class="cmd syntax"><code>&lt;Z&gt;{<span class="optional-argument">&lt;attribute specification&gt;</span>}</code></pre>
<p>
The following delimiters <code>&lt;Z&gt;</code> for table cells are used:
</p>
<ul>
<li><code>;</code> for <code>&lt;th&gt;</code>
</li>
<li><code>,</code> for <code>&lt;td&gt;</code>
</li>
</ul>
<p>
Table cells end at the next table cell, table row, or table part,
or at the end of the content being split.
If <code><span class="optional-argument">&lt;attribute specification&gt;</span></code> is empty,
the curly brackets surrounding it may be omitted.
</p>
<h4 id="table-rows"><a class="permalink" href="#table-rows" aria-label="Permalink"></a>Table rows</h4>
<p>
<code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is split into table rows <code>&lt;tr&gt;</code>
according to leading occurrences of the following:
</p>
<pre class="cmd syntax"><code>=={<span class="optional-argument">&lt;attribute specification&gt;</span>}</code></pre>
<p>
Table rows end at the next table row or table part,
or at the end of the content being split.
If <code><span class="optional-argument">&lt;attribute specification&gt;</span></code> is empty,
the curly brackets surrounding it may be omitted.
</p>
<h4 id="table-parts"><a class="permalink" href="#table-parts" aria-label="Permalink"></a>Table parts</h4>
<p>
<code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is split into table parts <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, <code>&lt;tfoot&gt;</code>
according to leading occurrences of the following:
</p>
<pre class="cmd syntax"><code>&lt;Y&gt;{<span class="optional-argument">&lt;attribute specification&gt;</span>}</code></pre>
<p>
The following delimiters <code>&lt;Y&gt;</code> for table parts are used:
</p>
<ul>
<li><code>|^</code> for <code>&lt;thead&gt;</code>
</li>
<li><code>|~</code> for <code>&lt;tbody&gt;</code>
</li>
<li><code>|_</code> for <code>&lt;tfoot&gt;</code>
</li>
</ul>
<p>
Table parts end at the next table part,
or at the end of the content being split.
If <code><span class="optional-argument">&lt;attribute specification&gt;</span></code> is empty,
the curly brackets surrounding it may be omitted.
</p>
<h4 id="tables-without-parts"><a class="permalink" href="#tables-without-parts" aria-label="Permalink"></a>Example 1: table <em>without</em> <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, <code>&lt;tfoot&gt;</code> parts</h4>
<ul>
<li>CMD
<pre class="cmd"><code>''''
  ==
    ; A
    ; B
    ; C
    ; D
  ==
    , 1
    ,{r2} 2
    , 3
    , 4
  ==
    , 5
    ,{r3 c2} 6
  ==
    ,{c2} 7
  ==
    , 8
    ; ?
''''
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;table&gt;
&lt;tr&gt;
&lt;th&gt;A&lt;/th&gt;
&lt;th&gt;B&lt;/th&gt;
&lt;th&gt;C&lt;/th&gt;
&lt;th&gt;D&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td rowspan="2"&gt;2&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td rowspan="3" colspan="2"&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td colspan="2"&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;th&gt;?&lt;/th&gt;
&lt;/tr&gt;
&lt;/table&gt;
</code></pre>
</li>
<li>Rendered
<table>
<tr>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
</tr>
<tr>
<td>1</td>
<td rowspan="2">2</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>5</td>
<td rowspan="3" colspan="2">6</td>
</tr>
<tr>
<td colspan="2">7</td>
</tr>
<tr>
<td>8</td>
<th>?</th>
</tr>
</table>
</li>
</ul>
<h4 id="tables-with-parts"><a class="permalink" href="#tables-with-parts" aria-label="Permalink"></a>Example 2: table <em>with</em> <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, <code>&lt;tfoot&gt;</code> parts</h4>
<ul>
<li>CMD
<pre class="cmd"><code>''''
|^
  ==
    ; Meals
    ; Cost / \d
|:
  ==
    ; Lunch
    , 7
  ==
    ; Dinner
    , 10
|_
  ==
    ; Total
    ,{#total-cost .some-class}
      17
''''
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Meals&lt;/th&gt;
&lt;th&gt;Cost / $&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;th&gt;Lunch&lt;/th&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;Dinner&lt;/th&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;
&lt;tr&gt;
&lt;th&gt;Total&lt;/th&gt;
&lt;td id="total-cost" class="some-class"&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;/tfoot&gt;
&lt;/table&gt;
</code></pre>
</li>
<li>Rendered
<table>
<thead>
<tr>
<th>Meals</th>
<th>Cost / $</th>
</tr>
</thead>
<tbody>
<tr>
<th>Lunch</th>
<td>7</td>
</tr>
<tr>
<th>Dinner</th>
<td>10</td>
</tr>
</tbody>
<tfoot>
<tr>
<th>Total</th>
<td id="total-cost" class="some-class">17</td>
</tr>
</tfoot>
</table>
</li>
</ul>
<h3 id="escapes"><a class="permalink" href="#escapes" aria-label="Permalink"></a>Escapes</h3>
<div class="centred-flex">
<table>
<tr>
<th>CCH</th>
<th>HTML</th>
<th>Rendered</th>
<th>Description</th>
</tr>
<tr>
<td><code>\\</code></td>
<td><code>\</code></td>
<td>\</td>
<td>Backslash</td>
</tr>
<tr>
<td><code>\/</code></td>
<td><code></code></td>
<td></td>
<td>Empty string</td>
</tr>
<tr>
<td><code>\ /</code></td>
<td><code> </code></td>
<td> </td>
<td>Space</td>
</tr>
<tr>
<td><code>\ </code></td>
<td><code> </code></td>
<td> </td>
<td>Space</td>
</tr>
<tr>
<td><code>\~</code></td>
<td><code>~</code></td>
<td>~</td>
<td>Tilde</td>
</tr>
<tr>
<td><code>~</code></td>
<td><code>&amp;nbsp;</code></td>
<td>&nbsp;</td>
<td>Non-breaking space</td>
</tr>
<tr>
<td><code>\0</code></td>
<td><code>&amp;numsp;</code></td>
<td>&numsp;</td>
<td>Figure space</td>
</tr>
<tr>
<td><code>\,</code></td>
<td><code>&amp;thinsp;</code></td>
<td>&thinsp;</td>
<td>Thin space</td>
</tr>
<tr>
<td><code>\&amp;</code></td>
<td><code>&amp;amp;</code></td>
<td>&amp;</td>
<td>Ampersand (entity)</td>
</tr>
<tr>
<td><code>\&lt;</code></td>
<td><code>&amp;lt;</code></td>
<td>&lt;</td>
<td>Less than (entity)</td>
</tr>
<tr>
<td><code>\&gt;</code></td>
<td><code>&amp;gt;</code></td>
<td>&gt;</td>
<td>Greater than (entity)</td>
</tr>
<tr>
<td><code>\"</code></td>
<td><code>&amp;quot;</code></td>
<td>&quot;</td>
<td>Double quote (entity)</td>
</tr>
<tr>
<td><code>...</code></td>
<td><code>…</code></td>
<td>…</td>
<td><code>U+2026 HORIZONTAL ELLIPSIS</code></td>
</tr>
<tr>
<td><code>---</code></td>
<td><code>—</code></td>
<td>—</td>
<td><code>U+2014 EM DASH</code></td>
</tr>
<tr>
<td><code>--</code></td>
<td><code>–</code></td>
<td>–</td>
<td><code>U+2013 EN DASH</code></td>
</tr>
<tr>
<td><code>\P</code></td>
<td><code>¶</code></td>
<td>¶</td>
<td><code>U+00B6 PILCROW SIGN</code></td>
</tr>
<tr>
<td><code>\d</code></td>
<td><code>$</code></td>
<td>$</td>
<td>Dollar sign</td>
</tr>
<tr>
<td><code>\#</code></td>
<td><code>#</code></td>
<td>#</td>
<td>Hash</td>
</tr>
<tr>
<td><code>\[</code></td>
<td><code>[</code></td>
<td>[</td>
<td>Opening square bracket</td>
</tr>
<tr>
<td><code>\]</code></td>
<td><code>]</code></td>
<td>]</td>
<td>Closing square bracket</td>
</tr>
<tr>
<td><code>\(</code></td>
<td><code>(</code></td>
<td>(</td>
<td>Opening round bracket</td>
</tr>
<tr>
<td><code>\)</code></td>
<td><code>)</code></td>
<td>)</td>
<td>Closing round bracket</td>
</tr>
<tr>
<td><code>\*</code></td>
<td><code>*</code></td>
<td>*</td>
<td>Asterisk</td>
</tr>
<tr>
<td><code>\_</code></td>
<td><code>_</code></td>
<td>_</td>
<td>Underscore</td>
</tr>
<tr>
<td><code>\=</code></td>
<td><code>&lt;hr&gt;</code></td>
<td><hr></td>
<td>Thematic break</td>
</tr>
<tr>
<td><code>\+</code></td>
<td><code>&lt;br&gt;</code></td>
<td><br></td>
<td>Line break</td>
</tr>
</table>
</div>
<h3 id="line-continuations"><a class="permalink" href="#line-continuations" aria-label="Permalink"></a>Line continuations</h3>
<p>
Use backslashes for line continuation.
All leading whitespace on the next line is stripped.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>(Line 1)\
  (Line 2)
(Line 3) \
       (Line 4)
</code></pre>
</li>
<li>HTML
<pre class="html"><code>(Line 1)(Line 2)
(Line 3) (Line 4)
</code></pre>
</li>
</ul>
<h3 id="reference-definitions"><a class="permalink" href="#reference-definitions" aria-label="Permalink"></a>Reference-style definitions</h3>
<pre class="cmd syntax"><code><span class="repeatable-delimiter">@</span>[<span class="mandatory-argument">&lt;LABEL&gt;</span>]{<span class="optional-argument">&lt;attribute specification&gt;</span>} <span class="optional-argument">&lt;address&gt;</span> <span class="optional-argument">&lt;title&gt;</span> <span class="repeatable-delimiter">@</span></code></pre>
<p>
Reference style definition
for an <a href="#reference-style-images">image</a> or a <a href="#reference-style-links">link</a>.
</p>
<p>
If <code><span class="optional-argument">&lt;attribute specification&gt;</span></code> is empty,
the curly brackets surrounding it may be omitted.
</p>
<p>
The referencing <code><span class="mandatory-argument">&lt;LABEL&gt;</span></code> is case insensitive.
For definitions whose <code><span class="optional-argument">&lt;address&gt;</span></code> or <code><span class="optional-argument">&lt;title&gt;</span></code>
contains one or more consecutive at signs
which are not protected by CMD literals,
use a longer run of <span class="repeatable-delimiter">at signs</span> in the delimiters.
</p>
<p>
<code><span class="optional-argument">&lt;address&gt;</span></code> is used for
<code>src</code> in <a href="#reference-style-images">images</a> and
<code>href</code> in <a href="#reference-style-links">links</a>.
</p>
<p>
All reference-style definitions are read and stored.
If the same label (which is case insensitive)
is specified more than once,
the latest definition shall prevail.
</p>
<h3 id="images"><a class="permalink" href="#images" aria-label="Permalink"></a>Images</h3>
<h4 id="inline-style-images"><a class="permalink" href="#inline-style-images" aria-label="Permalink"></a>Inline-style images</h4>
<pre class="cmd syntax"><code>![<span class="mandatory-argument">&lt;ALT&gt;</span>](<span class="optional-argument">&lt;src&gt;</span> <span class="optional-argument">&lt;title&gt;</span>)</code></pre>
<p>
Unlike John Gruber's markdown, <code><span class="optional-argument">&lt;title&gt;</span></code> is not surrounded by quotes.
If quotes are supplied to <code><span class="optional-argument">&lt;title&gt;</span></code>,
they are automatically escaped as <code>&amp;quot;</code>.
</p>
<p>
Produces the image
<code>&lt;img<span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span>&gt;</code>,
where <code><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span></code> is the sequence of attributes
built from <code><span class="mandatory-argument">&lt;ALT&gt;</span></code>, <code><span class="optional-argument">&lt;src&gt;</span></code>, and <code><span class="optional-argument">&lt;title&gt;</span></code>.
For <code><span class="mandatory-argument">&lt;ALT&gt;</span></code>, <code><span class="optional-argument">&lt;src&gt;</span></code>, or <code><span class="optional-argument">&lt;title&gt;</span></code> containing
one or more closing square or round brackets,
use <a href="#escapes">escapes</a> or <a href="#cmd-literals">CMD literals</a>.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>![Dr~Nicolaes Tulp giving an anatomy lesson using a corpse](
  /rembrandt-anatomy.jpg
  The Anatomy Lesson of Dr~Nicolaes Tulp \(Rembrandt\)
)
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;img alt="Dr&amp;nbsp;Nicolaes Tulp giving an anatomy lesson using a corpse" src="/rembrandt-anatomy.jpg" title="The Anatomy Lesson of Dr&amp;nbsp;Nicolaes Tulp (Rembrandt)"&gt;
</code></pre>
</li>
<li>Rendered
<p>
<img alt="Dr&nbsp;Nicolaes Tulp giving an anatomy lesson using a corpse" src="/rembrandt-anatomy.jpg" title="The Anatomy Lesson of Dr&nbsp;Nicolaes Tulp (Rembrandt)">
</p>
</li>
</ul>
<h4 id="reference-style-images"><a class="permalink" href="#reference-style-images" aria-label="Permalink"></a>Reference-style images</h4>
<pre class="cmd syntax"><code>![<span class="mandatory-argument">&lt;ALT&gt;</span>][<span class="optional-argument">&lt;label&gt;</span>]</code></pre>
<p>
To be used in conjunction with a <a href="#reference-definitions">reference-style definition</a>.
</p>
<p>
A single space may be included
between <code>[<span class="mandatory-argument">&lt;ALT&gt;</span>]</code> and <code>[<span class="optional-argument">&lt;label&gt;</span>]</code>.
The referencing <code><span class="optional-argument">&lt;label&gt;</span></code> is case insensitive.
If <code><span class="optional-argument">&lt;label&gt;</span></code> is empty,
the square brackets surrounding it may be omitted,
and <code><span class="mandatory-argument">&lt;ALT&gt;</span></code> is used as the label.
</p>
<p>
Produces the image
<code>&lt;img<span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span>&gt;</code>,
where <code><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span></code> is the sequence of attributes
built from <code><span class="mandatory-argument">&lt;ALT&gt;</span></code> and the attribute specifications
for the corresponding <a href="#reference-definitions">reference-style image definition</a>.
</p>
<p>
Whitespace around <code><span class="optional-argument">&lt;label&gt;</span></code> is stripped.
For images whose <code><span class="mandatory-argument">&lt;ALT&gt;</span></code> or <code><span class="optional-argument">&lt;label&gt;</span></code> contains
one or more closing square brackets,
use <a href="#escapes">escapes</a> or <a href="#cmd-literals">CMD literals</a>.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>@[moses-breaking-tablets]{w200}
  /rembrandt-moses.jpg
  Moses Breaking the Tablets of the Law (Rembrandt)
@

![A pissed-off Moses, about to smash the Law Tablets][moses-breaking-tablets]
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;img alt="A pissed-off Moses, about to smash the Law Tablets" width="200" src="/rembrandt-moses.jpg" title="Moses Breaking the Tablets of the Law (Rembrandt)"&gt;
</code></pre>
</li>
<li>Rendered
<p>
<img alt="A pissed-off Moses, about to smash the Law Tablets" width="200" src="/rembrandt-moses.jpg" title="Moses Breaking the Tablets of the Law (Rembrandt)">
</p>
</li>
</ul>
<h3 id="links"><a class="permalink" href="#links" aria-label="Permalink"></a>Links</h3>
<h4 id="inline-style-links"><a class="permalink" href="#inline-style-links" aria-label="Permalink"></a>Inline-style links</h4>
<pre class="cmd syntax"><code>[<span class="mandatory-argument">&lt;CONTENT&gt;</span>](<span class="optional-argument">&lt;href&gt;</span> <span class="optional-argument">&lt;title&gt;</span>)</code></pre>
<p>
Unlike John Gruber's markdown, <code><span class="optional-argument">&lt;title&gt;</span></code> is not surrounded by quotes.
If quotes are supplied to <code><span class="optional-argument">&lt;title&gt;</span></code>,
they are automatically escaped as <code>&amp;quot;</code>.
</p>
<p>
Produces the link
<code>&lt;a<span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span>&gt;<span class="mandatory-argument">&lt;CONTENT&gt;</span>&lt;/a&gt;</code>,
where <code><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span></code> is the sequence of attributes
built from <code><span class="optional-argument">&lt;href&gt;</span></code> and <code><span class="optional-argument">&lt;title&gt;</span></code>.
Whitespace around <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is stripped.
For <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code>, <code><span class="optional-argument">&lt;href&gt;</span></code>, or <code><span class="optional-argument">&lt;title&gt;</span></code> containing
one or more closing square or round brackets,
use <a href="#escapes">escapes</a> or <a href="#cmd-literals">CMD literals</a>.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>[Wikimedia Commons](
  https://commons.wikimedia.org/wiki/Main_Page
  Wikimedia Commons
)
  \+
[Wikimedia Commons without title](https://commons.wikimedia.org/wiki/Main_Page)
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;a href="https://commons.wikimedia.org/wiki/Main_Page" title="Wikimedia Commons"&gt;Wikimedia Commons&lt;/a&gt;&lt;br&gt;
&lt;a href="https://commons.wikimedia.org/wiki/Main_Page"&gt;Wikimedia Commons without title&lt;/a&gt;
</code></pre>
</li>
<li>Rendered
<p>
<a href="https://commons.wikimedia.org/wiki/Main_Page" title="Wikimedia Commons">Wikimedia Commons</a><br>
<a href="https://commons.wikimedia.org/wiki/Main_Page">Wikimedia Commons without title</a>
</p>
</li>
</ul>
<h4 id="reference-style-links"><a class="permalink" href="#reference-style-links" aria-label="Permalink"></a>Reference-style links</h4>
<pre class="cmd syntax"><code>[<span class="mandatory-argument">&lt;CONTENT&gt;</span>][<span class="optional-argument">&lt;label&gt;</span>]</code></pre>
<p>
To be used in conjunction with a <a href="#reference-definitions">reference-style definition</a>.
</p>
<p>
A single space may be included
between <code>[<span class="mandatory-argument">&lt;CONTENT&gt;</span>]</code> and <code>[<span class="optional-argument">&lt;label&gt;</span>]</code>.
The referencing <code><span class="optional-argument">&lt;label&gt;</span></code> is case insensitive.
If <code><span class="optional-argument">&lt;label&gt;</span></code> is empty,
the square brackets surrounding it may be omitted,
and <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is used as the label.
</p>
<p>
Produces the link
<code>&lt;a<span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span>&gt;<span class="mandatory-argument">&lt;CONTENT&gt;</span>&lt;/a&gt;</code>,
where <code><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span></code> is the sequence of attributes
built from the attribute specifications
for the corresponding <a href="#reference-definitions">reference-style image definition</a>.
</p>
<p>
Whitespace around <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> and <code><span class="optional-argument">&lt;label&gt;</span></code> is stripped.
For links whose <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> or <code><span class="optional-argument">&lt;label&gt;</span></code> contains
one or more closing square brackets,
use <a href="#escapes">escapes</a> or <a href="#cmd-literals">CMD literals</a>.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>@[wikipedia]
  https://en.wikipedia.org/wiki/Main_Page
  Wikipedia, the free encyclopedia
@

[Wikipedia's home page][wikipedia] \+
[Wikipedia][] \+
[Wikipedia]
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;a href="https://en.wikipedia.org/wiki/Main_Page" title="Wikipedia, the free encyclopedia"&gt;Wikipedia's home page&lt;/a&gt;&lt;br&gt;
&lt;a href="https://en.wikipedia.org/wiki/Main_Page" title="Wikipedia, the free encyclopedia"&gt;Wikipedia&lt;/a&gt;&lt;br&gt;
&lt;a href="https://en.wikipedia.org/wiki/Main_Page" title="Wikipedia, the free encyclopedia"&gt;Wikipedia&lt;/a&gt;
</code></pre>
</li>
<li>Rendered
<p>
<a href="https://en.wikipedia.org/wiki/Main_Page" title="Wikipedia, the free encyclopedia">Wikipedia's home page</a><br>
<a href="https://en.wikipedia.org/wiki/Main_Page" title="Wikipedia, the free encyclopedia">Wikipedia</a><br>
<a href="https://en.wikipedia.org/wiki/Main_Page" title="Wikipedia, the free encyclopedia">Wikipedia</a>
</p>
</li>
</ul>
<h3 id="headings"><a class="permalink" href="#headings" aria-label="Permalink"></a>Headings</h3>
<pre class="cmd syntax"><code>#{<span class="optional-argument">&lt;attribute specification&gt;</span>}> <span class="mandatory-argument">&lt;CONTENT&gt;</span> #</code></pre>
<p>
Produces the heading
<code>&lt;h1<span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span>&gt;<span class="mandatory-argument">&lt;CONTENT&gt;</span>&lt;/h1&gt;</code>,
where <code><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span></code> is the sequence of attributes
<a href="#attribute-specifications">built from <code><span class="optional-argument">&lt;attribute specification&gt;</span></code></a>.
</p>
<p>
Whitespace around <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is stripped.
For <code>&lt;h2&gt;</code> to <code>&lt;h6&gt;</code>, use 2 to 6 delimiting hashes respectively.
For <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> containing the delimiting number of
or more consecutive hashes, use <a href="#cmd-literals">CMD literals</a>.
</p>
<ul>
<li>CMD
<pre class="cmd"><code>###{#some-id} Heading with id ###
#### Heading without id ####
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;h3 id="some-id"&gt;Heading with id&lt;/h3&gt;
&lt;h4&gt;Heading without id&lt;/h4&gt;
</code></pre>
</li>
</ul>
<h3 id="inline-semantics"><a class="permalink" href="#inline-semantics" aria-label="Permalink"></a>Inline semantics</h3>
<pre class="cmd syntax"><code>&lt;X&gt;{<span class="optional-argument">&lt;attribute specification&gt;</span>} <span class="mandatory-argument">&lt;CONTENT&gt;</span> &lt;X&gt;</code></pre>
<p>
<code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> must be non-empty.
If <code><span class="optional-argument">&lt;attribute specification&gt;</span></code> is empty,
the curly brackets surrounding it may be omitted.
</p>
<p>
Produces the inline semantic
<code>&lt;<span class="mandatory-argument">&lt;TAG NAME&gt;</span><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span>
<span class="mandatory-argument">&lt;CONTENT&gt;</span>&lt;/<span class="mandatory-argument">&lt;TAG NAME&gt;</span>&gt;</code>,
where <code><span class="mandatory-argument">&lt;ATTRIBUTES&gt;</span></code> is the sequence of attributes
<a href="#attribute-specifications">built from <code><span class="optional-argument">&lt;attribute specification&gt;</span></code></a>.
</p>
<p>
Whitespace around <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> is stripped.
For <code><span class="mandatory-argument">&lt;CONTENT&gt;</span></code> containing one or more occurrences of <code>*</code> or <code>_</code>,
use <a href="#cmd-literals">CMD literals</a> or the <a href="#escapes">escapes</a> <code>\*</code> and <code>\_</code>.
</p>
<p>
The following delimiters <code>&lt;X&gt;</code>,
equal to one or two delimiting characters <code>&lt;C&gt;</code>,
are used:
</p>
<ul>
<li><code>**</code> for <code>&lt;strong&gt;</code>
(strong importance, seriousness, etc.)
</li>
<li><code>*</code> for <code>&lt;em&gt;</code>
(stress emphasis, sarcasm, etc.)
</li>
<li><code>__</code> for <code>&lt;b&gt;</code>
(bring to attention <em>without</em> strong importance,&nbsp;e.g. keywords)
</li>
<li><code>_</code> for <code>&lt;i&gt;</code>
(offset text <em>without</em> stress emphasis, e.g.&nbsp;book titles, Latin)
</li>
</ul>
<p>
<strong>In HTML5, <code>&lt;b&gt;</code> and <code>&lt;i&gt;</code> are <em>not</em> deprecated.</strong>
See <a href="https://www.w3.org/International/questions/qa-b-and-i-tags.en">W3C on using <code>&lt;b&gt;</code> and <code>&lt;i&gt;</code> elements</a>.
</p>
<p>
In the implementation, matches are sought in the following order
(for brevity, <code>C</code> is used in place of <code>&lt;C&gt;</code>,
and <code>spec</code> in place of <code>attribute specification</code>, below):
</p>
<div class="centred-flex">
<table>
<thead>
<tr>
<th>Type</th>
<th>Form</th>
</tr>
</thead>
<tbody>
<tr>
<td>33</td>
<td><code>CCC{<span class="optional-argument">&lt;inner spec&gt;</span>} <span class="mandatory-argument">&lt;INNER CONTENT&gt;</span> CCC</code></td>
</tr>
<tr>
<td>312</td>
<td><code>CCC{<span class="optional-argument">&lt;inner spec&gt;</span>} <span class="mandatory-argument">&lt;INNER CONTENT&gt;</span> C <span class="mandatory-argument">&lt;OUTER CONTENT&gt;</span> CC</code></td>
</tr>
<tr>
<td>321</td>
<td><code>CCC{<span class="optional-argument">&lt;inner spec&gt;</span>} <span class="mandatory-argument">&lt;INNER CONTENT&gt;</span> CC <span class="mandatory-argument">&lt;OUTER CONTENT&gt;</span> C</code></td>
</tr>
<tr>
<td>22</td>
<td><code>CC{<span class="optional-argument">&lt;spec&gt;</span>} <span class="mandatory-argument">&lt;CONTENT&gt;</span> CC</code></td>
</tr>
<tr>
<td>11</td>
<td><code>C{<span class="optional-argument">&lt;spec&gt;</span>} <span class="mandatory-argument">&lt;CONTENT&gt;</span> C</code></td>
</tr>
</tbody>
</table>
</div>
<p>
33 is effectively 312 with empty <code><span class="mandatory-argument">&lt;OUTER CONTENT&gt;</span></code>.
Once such a pattern has been matched,
only three cases need to be handled for the resulting match object:
</p>
<ul>
<li>2-layer special (for 33):<br>
<pre class="cmd syntax"><code>&lt;X&gt;&lt;Y&gt;{<span class="optional-argument">&lt;inner spec&gt;</span>} <span class="mandatory-argument">&lt;INNER CONTENT&gt;</span> &lt;Y&gt;&lt;X&gt;</code></pre>
</li>
<li>2-layer general (for 312, 321):<br>
<pre class="cmd syntax"><code>&lt;X&gt;&lt;Y&gt;{<span class="optional-argument">&lt;inner spec&gt;</span>} <span class="mandatory-argument">&lt;INNER CONTENT&gt;</span> &lt;Y&gt; <span class="mandatory-argument">&lt;OUTER CONTENT&gt;</span> &lt;X&gt;</code></pre>
</li>
<li>1-layer case (for 22, 11):<br>
<pre class="cmd syntax"><code>&lt;X&gt;{<span class="optional-argument">&lt;spec&gt;</span>} <span class="mandatory-argument">&lt;CONTENT&gt;</span> &lt;X&gt;</code></pre>
</li>
</ul>
<p>
Recursive calls are used to process nested inline semantics.
</p>
<div class="centred-flex">
<table>
<thead>
<tr>
<th>CCH</th>
<th>Rendered</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>***strong-em***</code></td>
<td><strong><em>strong-em</em></strong></td>
</tr>
<tr>
<td><code>***strong-em* strong**</code></td>
<td><strong><em>strong-em</em> strong</strong></td>
</tr>
<tr>
<td><code>***em-strong** em*</code></td>
<td><em><strong>em-strong</strong> em</em></td>
</tr>
<tr>
<td><code>**strong**</code></td>
<td><strong>strong</strong></td>
</tr>
<tr>
<td><code>*em*</code></td>
<td><em>em</em></td>
</tr>
<tr>
<td><code>___b-i___</code></td>
<td><b><i>b-i</i></b></td>
</tr>
<tr>
<td><code>___b-i_ b__</code></td>
<td><b><i>b-i</i> b</b></td>
</tr>
<tr>
<td><code>___i-b__ i_</code></td>
<td><i><b>i-b</b> i</i></td>
</tr>
<tr>
<td><code>__b__</code></td>
<td><b>b</b></td>
</tr>
<tr>
<td><code>_i_</code></td>
<td><i>i</i></td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>CMD
<pre class="cmd"><code>**Do not confuse `&lt;strong&gt;` and `&lt;em&gt;` with `&lt;b&gt;` and `&lt;i&gt;`.** \+
They are *not* the same. \+
Meals come with __rice__ or __pasta__. \+
I _{.translator-supplied} am_ the LORD.
</code></pre>
</li>
<li>HTML
<pre class="html"><code>&lt;strong&gt;Do not confuse &lt;code&gt;&amp;lt;strong&amp;gt;&lt;/code&gt; and &lt;code&gt;&amp;lt;em&amp;gt;&lt;/code&gt; with &lt;code&gt;&amp;lt;b&amp;gt;&lt;/code&gt; and &lt;code&gt;&amp;lt;i&amp;gt;&lt;/code&gt;.&lt;/strong&gt;&lt;br&gt;
They are &lt;em&gt;not&lt;/em&gt; the same.&lt;br&gt;
Meals come with &lt;b&gt;rice&lt;/b&gt; or &lt;b&gt;pasta&lt;/b&gt;.&lt;br&gt;
I &lt;i class="translator-supplied"&gt;am&lt;/i&gt; the LORD.
</code></pre>
</li>
<li>Rendered
<p>
<strong>Do not confuse <code>&lt;strong&gt;</code> and <code>&lt;em&gt;</code> with <code>&lt;b&gt;</code> and <code>&lt;i&gt;</code>.</strong><br>
They are <em>not</em> the same.<br>
Meals come with <b>rice</b> or <b>pasta</b>.<br>
I <i class="translator-supplied">am</i> the LORD.
</p>
</li>
</ul>
<h3 id="whitespace"><a class="permalink" href="#whitespace" aria-label="Permalink"></a>Whitespace</h3>
<p>
Throughout this document, "whitespace" refers specifically to ASCII whitespace.
See <a href="https://docs.python.org/3/library/string.html#string.whitespace"><code>string.whitespace</code></a>:
</p>
<blockquote>
[…] all ASCII characters that are considered whitespace.
[…] space, tab, linefeed, return, formfeed, and vertical tab.
</blockquote>
<p>
Whitespace is processed as follows:
</p>
<ol>
<li>Leading and trailing horizontal whitespace is removed.
</li>
<li>Empty lines are removed. (In the implementation,
consecutive newlines are replaced with a single newline.)
</li>
<li>Whitespace before line break elements <code>&lt;br&gt;</code> is removed.
</li>
<li>Whitespace for attributes is canonicalised:
<ul>
<li>a single space is used before the attribute name, and
</li>
<li>no whitespace is used around the equals sign.
</li>
</ul>
</li>
</ol>
<footer>
©&nbsp;2020&nbsp;Conway.
</footer>
</body>
</html>
